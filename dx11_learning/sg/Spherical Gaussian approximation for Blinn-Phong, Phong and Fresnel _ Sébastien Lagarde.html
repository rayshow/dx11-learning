<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0111)https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/ -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<title>Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel | S√©bastien Lagarde</title>
	<link rel="pingback" href="https://seblagarde.wordpress.com/xmlrpc.php">
	<link rel="alternate" type="application/rss+xml" title="S√©bastien Lagarde ¬ª Feed" href="https://seblagarde.wordpress.com/feed/">
<link rel="alternate" type="application/rss+xml" title="S√©bastien Lagarde ¬ª Comments Feed" href="https://seblagarde.wordpress.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="S√©bastien Lagarde ¬ª Spherical Gaussian approximation for Blinn-Phong, Phong and¬†Fresnel Comments Feed" href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/feed/">
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
	<link rel="stylesheet" id="all-css-0" href="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/saved_resource" type="text/css" media="all">
<link rel="stylesheet" id="print-css-1" href="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/global-print.css" type="text/css" media="print">
<link rel="stylesheet" id="all-css-2" href="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/saved_resource(1)" type="text/css" media="all">
<script type="text/javascript" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/saved_resource(2)"></script>
<link rel="stylesheet" id="all-css-0" href="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/style.css" type="text/css" media="all">
<!--[if lt IE 8]>
<link rel='stylesheet' id='highlander-comments-ie7-css'  href='https://s2.wp.com/wp-content/mu-plugins/highlander-comments/style-ie7.css?m=1351637563g&#038;ver=20110606' type='text/css' media='all' />
<![endif]-->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://seblagarde.wordpress.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="DONTNOD specular and glossiness¬†chart" href="https://seblagarde.wordpress.com/2012/04/30/dontnod-specular-and-glossiness-chart/">
<link rel="next" title="AMD Cubemapgen for physically based¬†rendering" href="https://seblagarde.wordpress.com/2012/06/10/amd-cubemapgen-for-physically-based-rendering/">
<meta name="generator" content="WordPress.com">
<link rel="canonical" href="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde.html">
<link rel="shortlink" href="http://wp.me/p1JJcX-dg">
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=json&url=https%3A%2F%2Fseblagarde.wordpress.com%2F2012%2F06%2F03%2Fspherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel%2F&for=wpcom-auto-discovery"><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=xml&url=https%3A%2F%2Fseblagarde.wordpress.com%2F2012%2F06%2F03%2Fspherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel%2F&for=wpcom-auto-discovery">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article">
<meta property="og:title" content="Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel">
<meta property="og:url" content="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/">
<meta property="og:description" content="Spherical Gaussian approximation for lighting calculation is not new to the graphic community[4][5][6][7][8]¬†but its use has¬† recently been adopted by the game developer community [1][2][3]. Spheri‚Ä¶">
<meta property="article:published_time" content="2012-06-03T23:37:02+00:00">
<meta property="article:modified_time" content="2015-12-11T01:35:30+00:00">
<meta property="og:site_name" content="S√©bastien Lagarde">
<meta property="og:image" content="https://seblagarde.files.wordpress.com/2012/06/sgfresnel-2.png">
<meta property="og:locale" content="en_US">
<meta name="twitter:site" content="@wordpressdotcom">
<meta name="twitter:image" content="https://seblagarde.files.wordpress.com/2012/06/comparesg-21.png?w=240">
<meta name="twitter:card" content="summary">
<meta property="fb:app_id" content="249643311490">
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom">
<link rel="shortcut icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/5bd2515918af5e1a7b6ce8ac0fb10039?s=16" sizes="16x16">
<link rel="icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/5bd2515918af5e1a7b6ce8ac0fb10039?s=16" sizes="16x16">
<link rel="apple-touch-icon-precomposed" href="https://secure.gravatar.com/blavatar/da58bfd0402386646653ba388b1a2007?s=114">
<link rel="openid.server" href="https://seblagarde.wordpress.com/?openidserver=1">
<link rel="openid.delegate" href="https://seblagarde.wordpress.com/">
<link rel="search" type="application/opensearchdescription+xml" href="https://seblagarde.wordpress.com/osd.xml" title="S√©bastien Lagarde">
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com">
<meta name="theme-color" content="#000000">
		<style id="wpcom-hotfix-masterbar-style">
			@media screen and (min-width: 783px) {
				#wpadminbar .quicklinks li#wp-admin-bar-my-account.with-avatar > a img {
					margin-top: 5px;
				}
			}
		</style>
		<style type="text/css">
.widget_twitter li {
	word-wrap: break-word;
}
</style>
<meta name="application-name" content="S√©bastien Lagarde"><meta name="msapplication-window" content="width=device-width;height=device-height"><meta name="msapplication-tooltip" content="Random thoughts about graphics in game"><meta name="msapplication-task" content="name=Subscribe;action-uri=https://seblagarde.wordpress.com/feed/;icon-uri=https://secure.gravatar.com/blavatar/5bd2515918af5e1a7b6ce8ac0fb10039?s=16"><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s2.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico"><meta name="title" content="Spherical Gaussian approximation for Blinn-Phong, Phong and¬†Fresnel | S√©bastien Lagarde on WordPress.com">
<meta name="description" content="Spherical Gaussian approximation for lighting calculation is not new to the graphic community[4][5][6][7][8]¬†but its use has¬† recently been adopted by the game developer community [1][2][3]. Spherical Gaussian (SG) is a type of spherical radial basis function (SRBF) [8] which can be used to¬†approximate spherical lobes with Gaussian-like function. This post will describe how SG can‚Ä¶">
		<style type="text/css">
			#header {
				background: transparent url(https://seblagarde.files.wordpress.com/2012/01/cropped-headerblog.jpg) no-repeat;
				border: none;
			}
		</style>
		<style type="text/css">
			#header h1,
			#header h1 a,
			#header h1 a:visited,
			#header h4,
			#header h4 a,
			#header h4 a:visited,
			.header-left {
				color: #ffffff;
			}
		</style>
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #000000; background-image: url('https://seblagarde.files.wordpress.com/2012/01/background2.jpg'); background-repeat: repeat; background-position: top right; background-attachment: fixed; }
</style>
		<script type="text/javascript" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/amzn_ads.js"></script>
		<script type="text/javascript">
		try { amznads.getAds("3033"); } catch(e) { /* ignore */ }
		</script><script type="text/javascript" src="https://aax.amazon-adsystem.com/e/dtb/bid?src=3033&u=https%3A%2F%2Fseblagarde.wordpress.com%2F2012%2F06%2F03%2Fspherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel%2F&cb=53493"></script>
		<script type="text/javascript">
		try {
			var a9_p = amznads.getKeys(),
			_ipw_custom = {
				wordAds: '0',
				adSafe: '1',
				domain: 'seblagarde.wordpress.com',
				pageURL: 'https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/'
			};
			if("undefined"!=typeof a9_p&&""!=a9_p&&null!==a9_p&&"[object Array]"===Object.prototype.toString.call(a9_p)){var a="",b=0,c=a9_p.length;a9_p.sort();for(var d=0;d<c;d++){a9_p[d-b]=a9_p[d-b].replace(/a1x6p/,"a160x600p");var e=a9_p[d-b].split("p");e[0]==a&&(a9_p.splice(d-b,1),b++);a=e[0]}_ipw_custom.amznPay=a9_p};document.close();
		} catch(e) {}
		</script>		<!-- IPONWEB header script -->
		<script type="text/javascript">
			window.__ATA = {
				scriptSrc: '//s.pubmine.com/showad.js',
				slotPrefix: 'automattic-id-',
				initAd: function(o) {
					var o = o || {},
						g = window,
						d = g.document,
						wr = d.write,
						id = g.__ATA.id();
					wr.call(d, '<div id="' + id + '" data-section="' + (o.sectionId || 0) + '"' + (o.type ? ('data-type="' + o.type + '"') : '') + ' ' + (o.forcedUrl ? ('data-forcedurl="' + o.forcedUrl + '"') : '') + ' style="width:' + (o.width || 0) + 'px; height:' + (o.height || 0) + 'px;">');
					g.__ATA.displayAd(id);
					wr.call(d, '</div>');
				},
				displayAd: function(id) {
					window.__ATA.ids = window.__ATA.ids || {};
					window.__ATA.ids[id] = 1;
				},
				customParams: _ipw_custom,
				id: function() {
					return window.__ATA.slotPrefix + (parseInt(Math.random() * 10000, 10) + 1 + (new Date()).getMilliseconds());
				}
			};
			(function(d, ata) {
				var pr = "https:" === d.location.protocol ? "https:" : "http:",
					src = pr + ata.scriptSrc,
					st = "text/javascript";
				d.write('<scr' + 'ipt type="' + st + '" src="' + src + '"><\/scr' + 'ipt>');
			})(window.document, window.__ATA);
		</script><script type="text/javascript" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/showad.js"></script>
		<script type="text/javascript">
		jQuery(window).ready(function () {
			jQuery("a.wpa-about").text("About these ads");
		});
		</script><link rel="amphtml" href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/amp/"><style type="text/css" id="syntaxhighlighteranchor"></style>
<script type="text/javascript">
	window.google_analytics_uacct = "UA-52447-2";
</script>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-52447-2']);
	_gaq.push(['_setDomainName', 'wordpress.com']);
	_gaq.push(['_initData']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})();
</script><script type="text/javascript" async="" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/ga.js"></script>
<script type="text/javascript" async="" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/saved_resource(3)"></script><script type="text/javascript" async="" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/saved_resource(4)"></script></head>

<body class="single single-post postid-822 single-format-standard custom-background mp6 customizer-styles-applied highlander-enabled highlander-light">

<div id="header">
	<div class="header-left">
					<h4><a href="https://seblagarde.wordpress.com/">S√©bastien Lagarde</a></h4>
				<p id="description">Random thoughts about graphics in game</p>
	</div>
	<div class="header-right">
		<form method="get" id="searchform" action="https://seblagarde.wordpress.com/">
			<div><label class="hidden" for="s">Search:</label>
			<input type="text" value="" name="s" id="s">
			<input type="submit" id="searchsubmit" value="Go"></div>
		</form>
	</div>
</div>
<div id="access">
	<div id="nav">
		<div id="supernav" class="navleft nav">
			<div class="menu"><ul><li><a href="https://seblagarde.wordpress.com/">Home</a></li><li class="page_item page-item-2585"><a href="https://seblagarde.wordpress.com/site-map/">All posts and recent&nbsp;updates</a></li><li class="page_item page-item-2"><a href="https://seblagarde.wordpress.com/about/">About</a></li></ul></div>
		</div>
		<div class="navright">
			<a class="rsslink" rel="nofollow" href="https://seblagarde.wordpress.com/feed/">Posts</a>
			<a class="rsslink" rel="nofollow" href="https://seblagarde.wordpress.com/comments/feed/">Comments</a>
		</div>
	</div>

	<div id="subnav" class="subnav nav">
			<div class="menu">
		<ul>
				<li class="cat-item cat-item-163795552"><a href="https://seblagarde.wordpress.com/category/use-all-posts-and-recent-updates-in-the-menu-to-natigate-this-blog/">Use "All posts and recent updates" in the Menu to natigate this blog</a>
</li>
		</ul>
	</div>
	</div>
</div>

<div id="wrap">
<div id="content">

	<div id="content-left">

		
			<div id="nav-above">
				<div class="nav-previous"><a href="https://seblagarde.wordpress.com/2012/04/30/dontnod-specular-and-glossiness-chart/" rel="prev"><span class="meta-nav">‚Üê</span> DONTNOD specular and glossiness&nbsp;chart</a></div>
				<div class="nav-next"><a href="https://seblagarde.wordpress.com/2012/06/10/amd-cubemapgen-for-physically-based-rendering/" rel="next">AMD Cubemapgen for physically based&nbsp;rendering <span class="meta-nav">‚Üí</span></a></div>
			</div>

			<div class="post-822 post type-post status-publish format-standard hentry category-use-all-posts-and-recent-updates-in-the-menu-to-natigate-this-blog tag-fresnel tag-fresnel-approximation tag-lighting-approximation tag-sg tag-spherical-gaussian tag-srbf">

				<div class="entry">

					<h1>Spherical Gaussian approximation for Blinn-Phong, Phong and&nbsp;Fresnel</h1>

					<div class="post-info">
						<p>
							<span class="time">June 3, 2012</span>
																						<span class="post-comments"><a href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/#comments">11 Comments</a></span>
																				</p>
					</div>

					<p>Spherical Gaussian approximation for lighting calculation is not new to the graphic community[4][5][6][7][8]&nbsp;but its use has&nbsp; recently been adopted by the game developer community [1][2][3].<br>
Spherical Gaussian (SG) is a type of spherical radial basis function (SRBF) [8] which can be used to&nbsp;approximate spherical lobes with Gaussian-like function.<br>
This post will describe how SG can be use to approximate Blinn-Phong lighting, Phong lighting and Fresnel.</p>
<p>Why care about SG approximation ?<br>
In the context of realtime rendering for games, the SG approximation allows to save a few instructions when performing lighting calculations. For modern graphics cards, saving few ALU in a shader is not always beneficial, but for older hardware like one can find in the PS3, every GPU cycle counts. This is less true for XBOX360 GPU, which performs better with arithmetic instructions, though this optimization can still be beneficial. It can also be used to schedule instructions in a different (low loaded) pipe on SPUs to increase performance [2].</p>
<p>Part of the work presented here credits to Matthew Jones (from Criterion Games) [9].</p>
<h2>Different spherical radial basis function</h2>
<p>The post talk about SG, but it is good to know that there is several different types of SRBF found in graphics papers.<br>
For completeness, I will talk quickly about SG and von Mises-Fisher (vMF) as this can be confusing.</p>
<p>SG definition can be found in [4]:<br>
<img src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/latex.php" alt="G(v; p,\lambda,\mu)=\mu e^{\lambda(v.p -1)} " title="G(v; p,\lambda,\mu)=\mu e^{\lambda(v.p -1)} " class="latex"> where p ‚àà ùïä2 is the lobe axis, Œª ‚àà (0,+‚àû) is the lobe sharpness,<br>
and Œº ‚àà ‚Ñù is the lobe amplitude (Œº ‚àà ‚Ñù3 for RGB color).</p>
<p>vMF is detailed in [8]:<br>
<img src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/latex(1).php" alt="\gamma(n.\mu;\theta) = \frac{k}{4\pi \sinh(k)} e^{k(n.\mu)} " title="\gamma(n.\mu;\theta) = \frac{k}{4\pi \sinh(k)} e^{k(n.\mu)} " class="latex"> with inverse width k and central direction Œº. vMFs are normalized to integrate<br>
to 1. Note: the notation from the paper [8] doesn‚Äôt match the notation from above.<br>
The paper presents an approximation of this formula for k &gt; 2 (which is almost always the case) : <img src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/latex(2).php" alt="\gamma(n.\mu;\theta)\approx \frac{k}{2\pi} e^{-k(1-n.\mu)} " title="\gamma(n.\mu;\theta)\approx \frac{k}{2\pi} e^{-k(1-n.\mu)} " class="latex"></p>
<p>As you can see, the formulation stays the same for a lobe sharpness &gt; 2, the difference lies only in the normalization constant for vMF, which we will omit. In the following, I will only refer to the SG function.</p>
<h2>Approximate Blinn-Phong with SG</h2>
<p>An approximation of the Blinn-Phong model with SG is provided in the supplementary material of [4]:<br>
<img src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/latex(3).php" alt="D(h)=(h.n)^k \approx e^{-k(1-(h.n))} " title="D(h)=(h.n)^k \approx e^{-k(1-(h.n))} " class="latex"></p>
<p>Here is the comparison of the accuracy of the approximation for low specular power (&lt;10), medium (25) and high( &gt; 50)</p>
<p><a href="https://seblagarde.files.wordpress.com/2012/06/comparesg-21.png"><img class="aligncenter size-full wp-image-857" title="CompareSG-2" src="https://seblagarde.files.wordpress.com/2012/06/comparesg-21.png?w=630" alt=""></a><br>
<span id="more-822"></span><br>
<a href="https://seblagarde.files.wordpress.com/2012/06/comparesg-5.png"><img class="aligncenter size-full wp-image-854" title="CompareSG-5" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/comparesg-5.png" alt=""></a><a href="https://seblagarde.files.wordpress.com/2012/06/comparesg-25.png"><img class="aligncenter size-full wp-image-855" title="CompareSG-25" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/comparesg-25.png" alt=""></a><a href="https://seblagarde.files.wordpress.com/2012/06/comparesg-50.png"><img class="aligncenter size-full wp-image-856" title="CompareSG-50" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/comparesg-50.png" alt=""></a>As shown above, the approximation is accurate for medium and high specular values. From my test, above 15 is accurate. For really low specular power ( &lt; 8) however, the result is a little poor but it still acceptable for a game.</p>
<p>Let‚Äôs analyze the performance. Translating the expression from above into code results to</p>
<pre>float dotHN = saturate(dot(H,N));
pow(dotHN, K) = exp(-K*(1-dotHN))</pre>
<p><img title="More..." src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/trans.gif" alt=""></p>
<p>A power function is generally implemented on the GPU as</p>
<pre>pow(a, b) = exp(log(a) * b)</pre>
<div>
<p>with exp (the base-e exponential) and log (the base-e logarithm). Exp/log instructions are often not implemented in hardware,&nbsp; and are replaced by both the base-2 exponential and the base-2 logarithm.</p>
</div>
<pre>exp(a) = exp2(a/log(2))
log(a) = log2(a*log(2))</pre>
<p>So</p>
<pre>pow(a,b) = exp2(log(2)/log(2) * log2(a)*b) = exp2(log2(a)*b)</pre>
<p>which is 3 ALU instructions: LOG2, MUL, EXP2</p>
<p>Going back to our SG approximation</p>
<pre>pow(dotHN, K)&nbsp;= exp(-K*(1-dotHN) = exp2(-(K/log(2))(1-dotHN))</pre>
<p>Refactoring to be more GPU friendly</p>
<pre>float A=K/log(2)
pow(dotHN, K)=&nbsp; exp2(A * dotHN - A)</pre>
<p>which is 3 ALU instructions&nbsp; : MUL, MAD, EXP2<br>
Here we have no gain on instruction count. The goal is to be able to process the K/log(2) offline (on the CPU) or ‚Äúburned-in‚Äù a previous computation in order to save the MUL instruction.</p>
<p>A good starting point would be to factor in the constant multiplication at decompression time of the glossiness factor. In our game we store glossiness in a texture as [0..1] and decompress it to a range of [2..2048] (see <a title="Adopting a physically based shading¬†model" href="https://seblagarde.wordpress.com/2011/08/17/hello-world/">Adopting a physically based shading model</a>)</p>
<pre>SpecularPower = exp2(10 * gloss + 1)</pre>
<p>Which is a MAD and a EXP2. With SG approximation we get</p>
<pre>ModifiedSpecularPower = 1/log(2) * exp2(10 * gloss + 1)
= exp2(10 * gloss + 1 + log2(1/log(2)))</pre>
<p>By precomputing the constant (the GPU compiler will do it anyway), we still have a MAD and a EXP2</p>
<pre>#define Log2Of1OnLn2_Plus1&nbsp;&nbsp;&nbsp; 1.528766
ModifiedSpecularPower = exp2(10 *&nbsp;gloss + Log2Of1OnLn2_Plus1);
SpecularLighting = exp2(ModifiedSpecularPower * dotHN - ModifiedSpecularPower);</pre>
<p>If you use a normalization term for energy conservation (see <a title="Adopting a physically based shading¬†model" href="https://seblagarde.wordpress.com/2011/08/17/hello-world/">Adopting a physically based shading model</a>), it needs to take into account the ModifiedSpecularPower</p>
<pre>(SpecularPower + 2)/8 = SpecularPower * 0.125 + 0.25
= ModifiedSpecularPower * Log(2) * 0.125 + 0.25
= ModifiedSpecularPower&nbsp; * 0.08664 + 0.25</pre>
<p>Which ends up as a single MAD. The complete code is</p>
<pre>#define LN2DIV8&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 0.08664
#define Log2Of1OnLn2_Plus1&nbsp;&nbsp; &nbsp;1.528766
float SphericalGaussianApprox(float CosX, float ModifiedSpecularPower)
{
    return exp2(ModifiedSpecularPower* CosX - ModifiedSpecularPower);
}
ModifiedSpecularPower = exp2(10 *&nbsp;gloss + Log2Of1OnLn2_Plus1);
SpecularLighting = (LN2DIV8 *&nbsp;ModifiedSpecularPower + 0.25) * SphericalGaussianApprox(DotNH, ModifiedSpecularPower);</pre>
<p>Compared to a standard power implementation, we effectively save 1 instruction.</p>
<p><strong>Better approximation</strong></p>
<p><span lang="EN-GB" style="font-size:11pt;font-family:&#39;Calibri&#39;, &#39;sans-serif&#39;;">SG approximation is rather poor for low specular power. Matthew Jones [9]&nbsp;&nbsp;</span> proposes to add a constant of one in the equation for better accuracy, based on the standard Fisher concentration factor given in the literature for the vMF function. He advertises that optimal solution lie between 0 and 1.</p>
<p><img src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/latex(4).php" alt="D(h)=(h.n)^k \approx e^{(k+x)((h.n)-1)} " title="D(h)=(h.n)^k \approx e^{(k+x)((h.n)-1)} " class="latex"></p>
<div>
<p>Therefore, I used Mathematica to find a best-fit for x. Here are two graphs showing the best-fit result for x on a small range,&nbsp; as well as for a high range of SpecularPower on the horizontal axis. The Mathematica file is provided at the end of this blog post.</p>
</div>
<p><span lang="EN-GB" style="font-size:11pt;font-family:&#39;Calibri&#39;, &#39;sans-serif&#39;;"><a href="https://seblagarde.files.wordpress.com/2012/06/sgbetterapproximationlowrange.png"><img class="aligncenter size-full wp-image-863" title="SGBetterApproximationLowRange" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/sgbetterapproximationlowrange.png" alt=""></a></span></p>
<p><a href="https://seblagarde.files.wordpress.com/2012/06/sgbetterapproximationhighrange.png"><img class="aligncenter size-full wp-image-866" title="SGBetterApproximationHighRange" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/sgbetterapproximationhighrange.png" alt=""></a></p>
<p>Graphs show us that the best-fit solution will converge as we increase SpecularPower to a value of x=0.75.</p>
<div>
<p>However, tests show that for x=0 or x = 1, we already get accurate results for medium and high specular. We can therefore focus on approximating x only for low SpecularPower range, as this is the range which causes trouble. Specular powers of 1 and 2 perform badly (you can see figure in Mathematica file), and will not be taken into account in the process. For SG approximation, it is best to only approximate SpecularPower &gt; 2.</p>
<p>Taking the mean of x solution for SpecularPower ranging from 3 to 15 we get x=0.775. The following expression could be a good candidate for more accurate SG approximation</p>
<p><img src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/latex(5).php" alt="D(h)=(h.n)^k \approx e^{(k+0.775)((h.n)-1)} " title="D(h)=(h.n)^k \approx e^{(k+0.775)((h.n)-1)} " class="latex"></p>
</div>
<p>Let‚Äôs compare</p>
<p><a href="https://seblagarde.files.wordpress.com/2012/06/sgbetterapproximation0775-1.png"><img class="aligncenter size-full wp-image-867" title="SGBetterApproximation0775-1" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/sgbetterapproximation0775-1.png" alt=""></a><a href="https://seblagarde.files.wordpress.com/2012/06/sgbetterapproximation0775-2.png"><img class="aligncenter size-full wp-image-868" title="SGBetterApproximation0775-2" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/sgbetterapproximation0775-2.png" alt=""></a></p>
<div>
<p>The graph shows that the new formulation (with x=0.775) is a better match for the power curve, but the accuracy is not distributed equally and x = 0 performs better at a higher peak. For SpecularPowers of 10 and above, the difference is subtle. From a performance point of view:</p>
</div>
<pre>pow(dotHN, K) = exp((K+0.775)*(dotHN-1)) = exp2((K+0.775)/Log(2)*(dotHN-1)</pre>
<p><span lang="EN-GB" style="font-size:11pt;font-family:&#39;Calibri&#39;, &#39;sans-serif&#39;;">The problem here compare to previous formulation is the added 0.775/log(2). It will add a ADD instruction which can‚Äôt be hidden in previous computation (but it can be precomputed offline if gloss factor is a know value).<br>
So we get ADD, MAD, EXP2 which is 3 instructions like our original power function. However, the LOG2 has been replaced by a ADD which benefits from better scheduling on PS3, so this still an improvement‚Ä¶</span></p>
<p><em>Added note:</em></p>
<p>‚Äì A exponential function is non-zero everywhere compared to a power function which can reach zero</p>
<pre>exp(1000 * 0 - 1000) != 0 
pow(0, 1000) == 0</pre>
<p>In practice, this is not an issue because you (should) multiply your specular BRDF by saturate(dot(N,L)), allowing zero at the boundaries of the hemisphere.</p>
<p>‚Äì With a power function implemented as exp2(log2(a) * b),&nbsp; for a = 0 we get exp2(-inf * 0) = exp2(NaN) = NaN.<br>
With an SG approximation, we never get a NaN.</p>
<p>‚Äì Other BRDFs can be represented with SG-like distributions, such as Ward or Beckmann [4]</p>
<h2>Approximate Phong with SG</h2>
<p>In the previous section, we approximated a cosine lobe for the Blinn-Phong shading model. Similarly, this approximation can be implemented for the Phong shading model. In this case,&nbsp;with multiple lights, we can get a significant improvement.</p>
<p>The Phong lighting model require the angle between R and V where R is the reflected light around normal or for more efficiency, R and L with R the reflected view vector around normal.</p>
<pre>pow(dot(R,L) = exp2(ModifiedSpecularPower * dot(R,L) - ModifiedSpecularPower);</pre>
<p>We refactor this code as</p>
<pre>float4 R2 = float4(ModifiedSpecularPower * R, -ModifiedSpecularPower);
SpecularLighting = exp2(dot(R2, float4(L, 1)));</pre>
<p>Each added light will be represented by a DOT4 and an EXP2.</p>
<pre>float4 R2 = float4(ModifiedSpecularPower * R, -ModifiedSpecularPower);
for (int LightIdx = 0, LightIdx &lt; NumLight; ++LightIdx)
{
    SpecularLighting = exp2(dot( R2, float4(L[LightIdx], 1) ) );
    (...)
}</pre>
<h2>Approximate Fresnel with SG</h2>
<p>SG can also be used to improve the Schlick&nbsp; approximation of the Fresnel term.</p>
<pre>float dotEH = saturate(dot(E, H))
FresnelTerm = SpecularColor + (1.0f - SpecularColor) * pow(1 - dotEH, 5);</pre>
<p>Let‚Äôs focus on the second part</p>
<pre>pow(1 - dotEH, 5)</pre>
<p>Which is a SUB, LOG2, MUL, EXP2<br>
We will apply the SG approximation to this expression with the added constant from the first section. In this case, we have a know the SpecularPower value in order to not add any additional instructions.&nbsp;We can also choose a constant x as the best fit solution for SpecularPower 5 which is x = 0.788 (see Mathematica file at end of the post for details of this result).</p>
<pre>pow(1 - dotEH, 5) = exp2((5 + 0.788)/Log(2) * ((1-dotEH) - 1)) = exp2(-8.35 * dotEH)</pre>
<p>Which is MUL, EXP2. We save 50% instructions.<br>
Here is a comparison graph</p>
<p><a href="https://seblagarde.files.wordpress.com/2012/06/sgfresnel-1.png"><img class="aligncenter size-full wp-image-873" title="SGFresnel-1" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/sgfresnel-1.png" alt=""></a></p>
<p>It looks pretty good for a 50% gain. However in practice, the subtle difference can become visible, especially with small angles. Taking an angle of 0, with the original Fresnel we get 0 for Fresnel value, but for SG approximation we get a value of exp2(-8.35) = 0,003 which in the context of HDR light and linear space lighting can become a visible artifact. It is possible to get a better approximation of Fresnel by using a 2nd-order polynomial instead of a simple constant for the value inside the exp2.</p>
<pre>pow(1 - dotEH, 5) = exp2(x * (dotEH * dotEH) + y * dotEH))</pre>
<p>Fitting x and y in Mathematica, we get:</p>
<pre>pow(1 - dotEH, 5) = exp2(-5.55473 * (dotEH * dotEH)- 6.98316 * dotEH))
= exp2((-5.55473 * EdotH - 6.98316) * EdotH)</pre>
<p>We refactor the expression using Horner‚Äôs form since it is more GPU friendly (because it is composed of MADDs), the last line resulting in 3 instruction MAD, MUL, EXP2. This allows us to save one additional instruction.</p>
<p>Graph comparison</p>
<p><a href="https://seblagarde.files.wordpress.com/2012/06/sgfresnel-2.png"><img class="aligncenter size-full wp-image-875" title="SGFresnel-2" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/sgfresnel-2.png" alt=""></a>This solution seems accurate enough. At an angle of 0, we get exp2(-12.53789)^=0.000168, which is 17 times smaller than previous approximation. We will still see artifacts in the extreme case, but the behavior is quite improved over the original implementation. In the end, the choice of an approximation depends on your tolerance to error.<br>
Last, as Christian Sch√ºler remember in the comment, it should be note that the exponentiation to 5 can simply be done with SUB, MUL,&nbsp;MUL,&nbsp;MUL instructions : First ^2, second ^4, third ^5 by multiplying with the original value. Even if we conserve the same number of instruction as the original form, this improve scheduling.</p>
<p>Edit 2015: Be careful, this optimization was valid on old NVidia graphic card like those found on PS3, on AMD GCN thing are different and using only mul is faster.</p>
<h2>Conclusion</h2>
<p>This post provided an application of a SG approximation, where the goal was to save a few ALU instructions. Again, for modern GPUs, this is not necessarily beneficial, but for older mainstream hardware, such as the PS3 and XBOX360 GPUs, it is a quite useful tool to have in your pocket.</p>
<p>The Mathematica file <a href="https://seblagarde.files.wordpress.com/2012/06/sphericalgaussianapproximation_blog.pdf">SphericalGaussianApproximation_blog</a> contains all the figures and results presented in this post. Feel free to try it out and play with it. Any feedback is welcomed.</p>
<p>I would like to thanks Colin Barr√©-Brisebois for reviewing the post and correcting my english <img src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/simple-smile.png" alt=":)" class="wp-smiley" style="height: 1em; max-height: 1em;"></p>
<h2>Reference</h2>
<p>[1] Kaplanyan, ‚ÄúCryENGINE 3: Reaching the Speed of Light‚Äù <a href="http://advances.realtimerendering.com/s2010/index.html">http://advances.realtimerendering.com/s2010/index.html</a><br>
[2] Coffin, ‚ÄúSPU-Based Deferred Shading in BATTLEFIELD 3 for Playstation 3‚Ä≥ <a href="http://www.slideshare.net/DICEStudio/spubased-deferred-shading-in-battlefield-3-for-playstation-3">http://www.slideshare.net/DICEStudio/spubased-deferred-shading-in-battlefield-3-for-playstation-3</a><br>
[3] Barr√©-Brisebois, ‚ÄúApproximating Translucency Revisited ‚Äì With ‚ÄúSimplified‚Äù Spherical Gaussian Exponentiation‚Äù, <a href="http://colinbarrebrisebois.com/2012/04/09/approximating-translucency-revisited-with-simplified-spherical-gaussian/">http://colinbarrebrisebois.com/2012/04/09/approximating-translucency-revisited-with-simplified-spherical-gaussian/</a><br>
[4] Wang, Ren, Gong, Snyder, Guo, ‚ÄúAll-Frequency Rendering with Dynamic, Spatially-Varying Reflectance‚Äù <a href="http://research.microsoft.com/en-us/um/people/johnsny/papers/sg.pdf">http://research.microsoft.com/en-us/um/people/johnsny/papers/sg.pdf </a>and <a href="http://research.microsoft.com/en-us/um/people/jpwang/paper_stuffs/sg_supp.pdf">http://research.microsoft.com/en-us/um/people/jpwang/paper_stuffs/sg_supp.pdf<br>
</a>[5] Iwasaki, Furuya, Dobashi, Nishita, ‚ÄúReal-time Rendering of Dynamic Scenes under All-frequency Lighting using Integral Spherical Gaussian‚Äù <a href="http://research.microsoft.com/en-us/um/people/jpwang/paper_stuffs/sg_supp.pdf">http://www.wakayama-u.ac.jp/~iwasaki/project/ibl/eg2012.pdf<br>
</a>[6] de Rousiers, Bousseau, Subr, Holzschuch, Ramamoorthi, ‚ÄúReal-Time Rough Refraction‚Äù&nbsp;<a href="http://graphics.berkeley.edu/papers/DeRousiers-RRR-2011-02/DeRousiers-RRR-2011-02.pdf">http://graphics.berkeley.edu/papers/DeRousiers-RRR-2011-02/DeRousiers-RRR-2011-02.pdf</a><br>
[7] Han, Sun, Ramamoorthi, Grinspun, ‚ÄúFrequency Domain Normal Map Filtering‚Äù <a href="http://www.cs.columbia.edu/cg/normalmap/index.html">http://www.cs.columbia.edu/cg/normalmap/index.html</a><br>
[8] Tsai, Shih, ‚ÄúAll-frequency precomputed radiance transfer using spherical radial basis functions and clustered tensor approximation‚Äù <a href="http://www.yzugraphics.cse.yzu.edu.tw/research/papers/TOG_2006/Paper.pdf">http://www.yzugraphics.cse.yzu.edu.tw/research/papers/TOG_2006/Paper.pdf</a><br>
[9] Personal communication with Matthew Jones of Criterion games</p>
		<div class="wpcnt">
			<div class="wpa wpmrec">
				<a class="wpa-about" href="https://wordpress.com/about-these-ads/" rel="nofollow">About these ads</a>
				<div class="u">
					<script type="text/javascript">
					(function(g){g.__ATA.initAd({sectionId:26942, width:300, height:250});})(window);
					</script><div id="automattic-id-4379" data-section="26942" style="width:300px; height:250px;"><iframe width="300" height="250" style="border:none;width:300px;height:250px;" frameborder="0" scrolling="no" name="fif_slot_automattic-id-_automattic-id-4379" id="fif_slot_automattic-id-_automattic-id-4379" src="javascript:"<html><body style='background:transparent;margin:0%;'></body></html>""></iframe></div>
				</div>
			</div>
		</div><div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-822" class="share-twitter sd-button share-icon" href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/?share=twitter&nb=1" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-822" class="share-facebook sd-button share-icon" href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/?share=facebook&nb=1" target="_blank" title="Share on Facebook"><span>Facebook<span class="share-count">5</span></span></a></li><li class="share-google-plus-1"><a rel="nofollow" data-shared="sharing-google-822" class="share-google-plus-1 sd-button share-icon" href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/?share=google-plus-1&nb=1" target="_blank" title="Click to share on Google+"><span>Google</span></a></li><li class="share-end"></li></ul></div></div></div><div class="sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-loaded" id="like-post-wrapper-25674879-822-56fb30ec3b5f5" data-src="//widgets.wp.com/likes/#blog_id=25674879&amp;post_id=822&amp;origin=seblagarde.wordpress.com&amp;obj_id=25674879-822-56fb30ec3b5f5" data-name="like-post-frame-25674879-822-56fb30ec3b5f5"><h3 class="sd-title">Like this:</h3><div class="likes-widget-placeholder post-likes-widget-placeholder" style="height: 55px; display: none;"><span class="button"><span>Like</span></span> <span class="loading">Loading...</span></div><iframe class="post-likes-widget jetpack-likes-widget" name="like-post-frame-25674879-822-56fb30ec3b5f5" height="55px" width="100%" frameborder="0" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/saved_resource(9).html"></iframe><span class="sd-text-color"></span><a class="sd-link-color"></a></div>
<div id="jp-relatedposts" class="jp-relatedposts" style="display: block;">
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
<div class="jp-relatedposts-items jp-relatedposts-items-minimal"><p class="jp-relatedposts-post jp-relatedposts-post0" data-post-id="1" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://seblagarde.wordpress.com/2011/08/17/hello-world/" title="Adopting a physically based shading model

Version : 1.31 - Living blog - First version was 2 August 2011 With permission of my company : Dontnod entertainment¬† http://www.dont-nod.com/ This last year sees a growing interest for physically based rendering. Physically based shading simplify parameters control for artists, allow more consistent look under different lighting condition and‚Ä¶" rel="nofollow" data-origin="822" data-position="0">Adopting a physically based shading model</a></span><span class="jp-relatedposts-post-context">In "Use "All posts and recent updates" in the Menu to natigate this blog"</span></p><p class="jp-relatedposts-post jp-relatedposts-post1" data-post-id="3316" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://seblagarde.wordpress.com/2014/12/01/inverse-trigonometric-functions-gpu-optimization-for-amd-gcn-architecture/" title="Inverse trigonometric functions GPU optimization for AMD GCN architecture

Version : 2.0 ‚Äì Living blog ‚Äì First version was 01 December 2014 First advice anybody have regarding inverse trigonometric functions (acos, asin, atan) is &quot;do not use it&quot;. And this is a good advise. It is often possible to get rid of all the trigonometric functions with trigonometric identities‚Ä¶" rel="nofollow" data-origin="822" data-position="1">Inverse trigonometric functions GPU optimization for AMD GCN architecture</a></span><span class="jp-relatedposts-post-context">In "Use "All posts and recent updates" in the Menu to natigate this blog"</span></p><p class="jp-relatedposts-post jp-relatedposts-post2" data-post-id="721" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://seblagarde.wordpress.com/2012/03/29/relationship-between-phong-and-blinn-lighting-model/" title="Relationship between Phong and Blinn lighting model

version : 1.1 ‚Äì Living blog ‚Äì First version was 29 March 2012 Phong and Blinn are the two most used lighting models in game development. The properties of the two have been debate a lot of time and I won&#39;t discuss this here. See [1] to know why you‚Ä¶" rel="nofollow" data-origin="822" data-position="2">Relationship between Phong and Blinn lighting model</a></span><span class="jp-relatedposts-post-context">In "Use "All posts and recent updates" in the Menu to natigate this blog"</span></p></div></div></div><div class="clear"></div>
					
					<!--
					<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/"
    dc:identifier="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/"
    dc:title="Spherical Gaussian approximation for Blinn-Phong, Phong and&nbsp;Fresnel"
    trackback:ping="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/trackback/" />
</rdf:RDF>					-->

				</div>

				<div class="post-meta">
					<p>
						<span class="categories">Filed under <a href="https://seblagarde.wordpress.com/category/use-all-posts-and-recent-updates-in-the-menu-to-natigate-this-blog/" rel="category tag">Use "All posts and recent updates" in the Menu to natigate this blog</a></span>
						<span class="tags">Tagged with <a href="https://seblagarde.wordpress.com/tag/fresnel/" rel="tag">Fresnel</a>, <a href="https://seblagarde.wordpress.com/tag/fresnel-approximation/" rel="tag">fresnel approximation</a>, <a href="https://seblagarde.wordpress.com/tag/lighting-approximation/" rel="tag">Lighting approximation</a>, <a href="https://seblagarde.wordpress.com/tag/sg/" rel="tag">SG</a>, <a href="https://seblagarde.wordpress.com/tag/spherical-gaussian/" rel="tag">spherical gaussian</a>, <a href="https://seblagarde.wordpress.com/tag/srbf/" rel="tag">SRBF</a></span>					</p>
				</div>

			</div>

			
						<p></p>

			<div id="comments">
	

	<h3 id="comments-title">11 Responses to <em>Spherical Gaussian approximation for Blinn-Phong, Phong and&nbsp;Fresnel</em>	</h3>

	<ol class="commentlist snap_preview">
				<li class="comment even thread-even depth-1 highlander-comment" id="li-comment-321">
		<div id="comment-321">
		<div class="comment-author vcard">
			<img alt="" src="https://0.gravatar.com/avatar/0fcf23f6111f7ae962c50f515d8c0186?s=40&d=identicon&r=G" class="avatar avatar-40" height="40" width="40">			<cite class="fn"><a href="http://timothylottes.blogspot.com/" rel="external nofollow" class="url">Timothy Lottes</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/#comment-321">June 4, 2012 at 1:37 am</a></div>

		<div class="comment-body"><p>Does GPU precision of log2 and exp2 have a visible effect on these approximations?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/?replytocom=321#respond" onclick="return addComment.moveForm( &quot;comment-321&quot;, &quot;321&quot;, &quot;respond&quot;, &quot;822&quot; )" aria-label="Reply to Timothy Lottes">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
		<li class="comment byuser comment-author-seblagarde bypostauthor odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-322">
		<div id="comment-322">
		<div class="comment-author vcard">
			<img alt="" src="https://0.gravatar.com/avatar/3d50dd95b36b7d788f02d3150fec97c0?s=40&d=identicon&r=G" class="avatar avatar-40" height="40" width="40">			<cite class="fn"><a href="https://seblagarde.wordpress.com/" rel="external nofollow" class="url">seblagarde</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/#comment-322">June 4, 2012 at 12:00 pm</a></div>

		<div class="comment-body"><p>I am not sure of your question. </p>
<p>If you talk about the GPU precision for the hardware implementation of log2/exp2 you know better than me :), but as pow is implemented with log2/exp2 (at least on PS3/XBOX360) this is the same result, or maybe slightly better due to the fact that we have only one exp2 involve.</p>
<p>If you talk about half/float precision, pow and these approximations have same problem.<br>
For high specular power (like 1024) I get banding artifact when I use half everywhere, both with pow and SG. To fix this, I use</p>
<p>half SphericalGaussianApprox(float CosX, half ModifiedRoughness)<br>
{<br>
	return exp2(ModifiedRoughness * CosX ‚Äì ModifiedRoughness);<br>
}</p>
<p>return ((LN2 * Glossiness+ 2) / 8) * (float)SphericalGaussianApprox(DotNH, Glossiness);</p>
<p>However, when using the flag ‚Äú‚Äìfastprecision‚Äù for PS3 GPU compiler, it still optimize to half and I get banding.<br>
For low specular, no visible issue as for Fresnel approximation.</p>
<p>Is it what you ask ?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/?replytocom=322#respond" onclick="return addComment.moveForm( &quot;comment-322&quot;, &quot;322&quot;, &quot;respond&quot;, &quot;822&quot; )" aria-label="Reply to seblagarde">Reply</a>		</div>
	</div>

	<ul class="children">
		<li class="comment even depth-2 highlander-comment" id="li-comment-324">
		<div id="comment-324">
		<div class="comment-author vcard">
			<img alt="" src="https://0.gravatar.com/avatar/0fcf23f6111f7ae962c50f515d8c0186?s=40&d=identicon&r=G" class="avatar avatar-40" height="40" width="40">			<cite class="fn"><a href="http://timothylottes.blogspot.com/" rel="external nofollow" class="url">Timothy Lottes</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/#comment-324">June 4, 2012 at 3:07 pm</a></div>

		<div class="comment-body"><p>Yeah, PS3 is what I was asking about, since I‚Äôm now very rusty there. Read-back of GPU results of those approximations would be interesting. BTW, on newer GPUs (at least for sure on NVIDIA) pow is still based on hardware log2 and exp2, also no half and a change to fused multiply add (better intermediate precision).</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/?replytocom=324#respond" onclick="return addComment.moveForm( &quot;comment-324&quot;, &quot;324&quot;, &quot;respond&quot;, &quot;822&quot; )" aria-label="Reply to Timothy Lottes">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="post pingback">
		<p>Pingback: <a href="http://colinbarrebrisebois.com/2012/04/09/approximating-translucency-revisited-with-simplified-spherical-gaussian/" rel="external nofollow" class="url">Approximating Translucency Revisited ‚Äì With ‚ÄúSimplified‚Äù Spherical Gaussian Exponentiation ¬´ ZigguratVertigo's Hideout</a></p>
	</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 highlander-comment" id="li-comment-325">
		<div id="comment-325">
		<div class="comment-author vcard">
			<img alt="" src="https://1.gravatar.com/avatar/d8dc4169e1d600fcfc9c5bf7a9058041?s=40&d=identicon&r=G" class="avatar avatar-40" height="40" width="40">			<cite class="fn">Brian Karis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/#comment-325">June 4, 2012 at 8:20 pm</a></div>

		<div class="comment-body"><p>Thank you very much for writing this. I tried using your previous spherical gaussian for fresnel and did not get good results for the reasons you list here. Dielectrics looked much brighter than they should. Plotting the relative error showed the reason. I haven‚Äôt tried your new approximation in a shader yet but the graphs look much better. Here is a comparison of the new approximation vs the old of the relative error for a 4% specular reflecting material:</p>
<p><a href="http://fooplot.com/#W3sidHlwZSI6MCwiZXEiOiIoMC4wNCswLjk2KjJeKCgtNS41NTQ3Mypjb3MoeCktNi45ODMxNikqY29zKHgpKSkvKDAuMDQrMC45NiooMS1jb3MoeCkpXjUpIiwiY29sb3IiOiIjMDAwMDAwIn0seyJ0eXBlIjowLCJlcSI6IigwLjA0KzAuOTYqMl4oLTguNjU2MTcqY29zKHgpKSkvKDAuMDQrMC45NiooMS1jb3MoeCkpXjUpIiwiY29sb3IiOiIjMDAwMDAwIn0seyJ0eXBlIjoxMDAwLCJ3aW5kb3ciOlsiLTAuODEwMDAwMDAwMDAwMDAwMiIsIjIuNDQiLCItMC41OTAwMDAwMDAwMDAwMDA1IiwiMS40MDk5OTk5OTk5OTk5OTk1Il19XQ--" rel="nofollow">http://fooplot.com/#W3sidHlwZSI6MCwiZXEiOiIoMC4wNCswLjk2KjJeKCgtNS41NTQ3Mypjb3MoeCktNi45ODMxNikqY29zKHgpKSkvKDAuMDQrMC45NiooMS1jb3MoeCkpXjUpIiwiY29sb3IiOiIjMDAwMDAwIn0seyJ0eXBlIjowLCJlcSI6IigwLjA0KzAuOTYqMl4oLTguNjU2MTcqY29zKHgpKSkvKDAuMDQrMC45NiooMS1jb3MoeCkpXjUpIiwiY29sb3IiOiIjMDAwMDAwIn0seyJ0eXBlIjoxMDAwLCJ3aW5kb3ciOlsiLTAuODEwMDAwMDAwMDAwMDAwMiIsIjIuNDQiLCItMC41OTAwMDAwMDAwMDAwMDA1IiwiMS40MDk5OTk5OTk5OTk5OTk1Il19XQ‚Äì</a></p>
<p>I have on the other hand liked the results I‚Äôve gotten for the spherical gaussian approximation for   the specular distribution. I use the constant of 1.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/?replytocom=325#respond" onclick="return addComment.moveForm( &quot;comment-325&quot;, &quot;325&quot;, &quot;respond&quot;, &quot;822&quot; )" aria-label="Reply to Brian Karis">Reply</a>		</div>
	</div>

	<ul class="children">
		<li class="comment byuser comment-author-seblagarde bypostauthor even depth-2 highlander-comment" id="li-comment-326">
		<div id="comment-326">
		<div class="comment-author vcard">
			<img alt="" src="https://0.gravatar.com/avatar/3d50dd95b36b7d788f02d3150fec97c0?s=40&d=identicon&r=G" class="avatar avatar-40" height="40" width="40">			<cite class="fn"><a href="https://seblagarde.wordpress.com/" rel="external nofollow" class="url">seblagarde</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/#comment-326">June 5, 2012 at 6:57 am</a></div>

		<div class="comment-body"><p>Thank you for your feedback. I use the new Fresnel approximation in our game and it is ok.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/?replytocom=326#respond" onclick="return addComment.moveForm( &quot;comment-326&quot;, &quot;326&quot;, &quot;respond&quot;, &quot;822&quot; )" aria-label="Reply to seblagarde">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-427">
		<div id="comment-427">
		<div class="comment-author vcard">
			<img alt="" src="https://2.gravatar.com/avatar/8918b44022dc1e822a0cf824e60d2a39?s=40&d=identicon&r=G" class="avatar avatar-40" height="40" width="40">			<cite class="fn"><a href="http://www.thetenthplanet.de/" rel="external nofollow" class="url">Christian Sch√ºler</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/#comment-427">August 11, 2012 at 10:52 pm</a></div>

		<div class="comment-body"><p>Hallo Sebastien<br>
The compiler should be able to factor the integer power pow(1 ‚Äì dotEH, 5).<br>
You should get MUL, MUL, MUL (first ^2, second ^4, third ^5 by multiplying with the original value). That‚Äôs the reason I use Schlick with a power of 4 instead of 5, which saves one MUL.<br>
If your compiler doesnt do this, complain.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/?replytocom=427#respond" onclick="return addComment.moveForm( &quot;comment-427&quot;, &quot;427&quot;, &quot;respond&quot;, &quot;822&quot; )" aria-label="Reply to Christian Sch√ºler">Reply</a>		</div>
	</div>

	<ul class="children">
		<li class="comment byuser comment-author-seblagarde bypostauthor even depth-2 highlander-comment" id="li-comment-432">
		<div id="comment-432">
		<div class="comment-author vcard">
			<img alt="" src="https://0.gravatar.com/avatar/3d50dd95b36b7d788f02d3150fec97c0?s=40&d=identicon&r=G" class="avatar avatar-40" height="40" width="40">			<cite class="fn"><a href="https://seblagarde.wordpress.com/" rel="external nofollow" class="url">seblagarde</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/#comment-432">August 13, 2012 at 12:14 pm</a></div>

		<div class="comment-body"><p>Hi Christian, </p>
<p>Good point! Right, the MUL way is fast and schedule well.<br>
However, I can complain about the PS3 cg compiler as it generate (always ?) the LOG2, MUL, EXP2 code, so it should be done by hand . I should add that on PS3 using power of 4 result in LOG2*4 (the factor 4 is merge in the LOG2 instruction) and EXP2, which is 2 instructions.<br>
Still I found the power 4 to be a bad approximation and I prefer the more accurate exp2(-8.35 * dotEH).</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/?replytocom=432#respond" onclick="return addComment.moveForm( &quot;comment-432&quot;, &quot;432&quot;, &quot;respond&quot;, &quot;822&quot; )" aria-label="Reply to seblagarde">Reply</a>		</div>
	</div>

	<ul class="children">
		<li class="comment byuser comment-author-seblagarde bypostauthor odd alt depth-3 highlander-comment" id="li-comment-448">
		<div id="comment-448">
		<div class="comment-author vcard">
			<img alt="" src="https://0.gravatar.com/avatar/3d50dd95b36b7d788f02d3150fec97c0?s=40&d=identicon&r=G" class="avatar avatar-40" height="40" width="40">			<cite class="fn"><a href="https://seblagarde.wordpress.com/" rel="external nofollow" class="url">seblagarde</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/#comment-448">August 27, 2012 at 7:20 pm</a></div>

		<div class="comment-body"><p>I wasn‚Äôt fully complete on the last comment.<br>
The MUL way result in 4 instructions : SUB, MUL,MUL,MUL, I forget the initial SUB. So this perform better than the original formula as MUL schedule better, but it still 4 instructions. Other approximation still helpful depends on the error tolerance.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="post pingback">
		<p>Pingback: <a href="http://www.filmicworlds.com/2015/03/17/combined-approximation-of-fresnelvisibility/" rel="external nofollow" class="url">Combined Approximation of Fresnel/Visibility | Filmic Worlds</a></p>
	</li><!-- #comment-## -->
		<li class="post pingback">
		<p>Pingback: <a href="http://amootan.com/unrealengine/396/physically-based-shading-on-mobile/" rel="external nofollow" class="url">Physically Based Shading on Mobile | UnrealEngine.biz</a></p>
	</li><!-- #comment-## -->
	</ol>


				<div id="respond" class="comment-respond js">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="https://seblagarde.wordpress.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<input type="hidden" id="highlander_comment_nonce" name="highlander_comment_nonce" value="fc0b2cf470"><input type="hidden" name="_wp_http_referer" value="/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/">
<input type="hidden" name="hc_post_as" id="hc_post_as" value="guest">

<div class="comment-form-field comment-textarea">
	
	<div id="comment-form-comment"><textarea tabindex="-1" style="position: absolute; top: -999px; left: 0px; right: auto; bottom: auto; border: 0px; padding: 0px; box-sizing: content-box; word-wrap: break-word; overflow: hidden; -webkit-transition: none; transition: none; height: 0px !important; min-height: 0px !important; font-family: Arial, Helvetica, Tahoma, Verdana, sans-serif; font-size: 14px; font-weight: 400; font-style: normal; letter-spacing: 0px; text-transform: none; text-decoration: none; word-spacing: 0px; text-indent: 0px; line-height: normal; width: 607.77783203125px;" class="autosizejs "></textarea><textarea id="comment" name="comment" title="Enter your comment here..." placeholder="Enter your comment here..." style="height: 35px; overflow: hidden; word-wrap: break-word; resize: none;"></textarea></div>
</div>

<div id="comment-form-identity" style="display: none;">

	<div id="comment-form-nascar">
		<p>Fill in your details below or click an icon to log in:</p>
		<ul>
			<li class="selected" style="display:none;">
				<a href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/#comment-form-guest" id="postas-guest" title="Guest">
					<span></span>
				</a>
			</li>
			<li>
				<a href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/#comment-form-load-service:WordPress.com" id="postas-wordpress" title="WordPress.com">
					<span></span>
				</a>
			</li>
			<li>
				<a href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/#comment-form-load-service:Twitter" id="postas-twitter" title="Twitter">
					<span></span>
				</a>
			</li>
			<li>
				<a href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/#comment-form-load-service:Facebook" id="postas-facebook" title="Facebook">
					<span></span>
				</a>
			</li>
			<li>
			<iframe id="googleplus-sign-in" name="googleplus-sign-in" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/saved_resource.html" width="24" height="24" scrolling="no" allowtransparency="true" seamless="seamless" frameborder="0"></iframe>
			</li>
		</ul>
	</div>

	<div id="comment-form-guest" class="comment-form-service selected">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
<a href="https://gravatar.com/site/signup/" target="_blank">				<img src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/ad516503a11cd5ca435acc9bb6523536" alt="Gravatar" width="25" class="no-grav">
</a>			</div>

				<div class="comment-form-fields">
				<div class="comment-form-field comment-form-email">
					<label for="email">Email <span class="required">(required)</span> <span class="nopublish">(Address never made public)</span></label>
					<div class="comment-form-input"><input id="email" name="email" type="email" value=""></div>
				</div>
				<div class="comment-form-field comment-form-author">
					<label for="author">Name <span class="required">(required)</span></label>
					<div class="comment-form-input"><input id="author" name="author" type="text" value=""></div>
				</div>
				<div class="comment-form-field comment-form-url">
					<label for="url">Website</label>
					<div class="comment-form-input"><input id="url" name="url" type="text" value=""></div>
				</div>
			</div>
	
		</div>
	</div>

	<div id="comment-form-wordpress" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/ad516503a11cd5ca435acc9bb6523536" alt="WordPress.com Logo" width="25" class="no-grav">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="wp_avatar" id="wordpress-avatar" class="comment-meta-wordpress" value="">
				<input type="hidden" name="wp_user_id" id="wordpress-user_id" class="comment-meta-wordpress" value="">
				<input type="hidden" name="wp_access_token" id="wordpress-access_token" class="comment-meta-wordpress" value="">
				<p class="comment-form-posting-as pa-wordpress"><strong></strong> You are commenting using your <span class="skimlinks-unlinked">WordPress.com</span> account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'wordpress' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-twitter" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/ad516503a11cd5ca435acc9bb6523536" alt="Twitter picture" width="25" class="no-grav">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="twitter_avatar" id="twitter-avatar" class="comment-meta-twitter" value="">
				<input type="hidden" name="twitter_user_id" id="twitter-user_id" class="comment-meta-twitter" value="">
				<input type="hidden" name="twitter_access_token" id="twitter-access_token" class="comment-meta-twitter" value="">
				<p class="comment-form-posting-as pa-twitter"><strong></strong> You are commenting using your Twitter account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'twitter' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-facebook" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/ad516503a11cd5ca435acc9bb6523536" alt="Facebook photo" width="25" class="no-grav">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="fb_avatar" id="facebook-avatar" class="comment-meta-facebook" value="">
				<input type="hidden" name="fb_user_id" id="facebook-user_id" class="comment-meta-facebook" value="">
				<input type="hidden" name="fb_access_token" id="facebook-access_token" class="comment-meta-facebook" value="">
				<p class="comment-form-posting-as pa-facebook"><strong></strong> You are commenting using your Facebook account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'facebook' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-googleplus" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/ad516503a11cd5ca435acc9bb6523536" alt="Google+ photo" width="25" class="no-grav">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="googleplus_avatar" id="googleplus-avatar" class="comment-meta-googleplus" value="">
				<input type="hidden" name="googleplus_user_id" id="googleplus-user_id" class="comment-meta-googleplus" value="">
				<input type="hidden" name="googleplus_access_token" id="googleplus-access_token" class="comment-meta-googleplus" value="">
				<p class="comment-form-posting-as pa-googleplus"><strong></strong> You are commenting using your Google+ account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'googleplus' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="https://seblagarde.wordpress.com/2012/06/03/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel/#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>


	<div id="comment-form-load-service" class="comment-form-service">
		<div class="comment-form-posting-as-cancel"><a href="javascript:HighlanderComments.cancelExternalWindow();">Cancel</a></div>
		<p>Connecting to %s</p>
	</div>

</div>

<script type="text/javascript">
var highlander_expando_javascript = function(){
	var input = document.createElement( 'input' ),
	    comment = jQuery( '#comment' );

	if ( 'placeholder' in input ) {
		comment.attr( 'placeholder', jQuery( '.comment-textarea label' ).remove().text() );
	}

	// Expando Mode: start small, then auto-resize on first click + text length
	jQuery( '#comment-form-identity' ).hide();
	jQuery( '#comment-form-subscribe' ).hide();
	jQuery( '#commentform .form-submit' ).hide();

	comment.css( { 'height':'10px' } ).one( 'focus', function() {
		var timer = setInterval( HighlanderComments.resizeCallback, 10 )
		jQuery( this ).animate( { 'height': HighlanderComments.initialHeight } ).delay( 100 ).queue( function(n) { clearInterval( timer ); HighlanderComments.resizeCallback(); n(); } );
		jQuery( '#comment-form-identity' ).slideDown();
		jQuery( '#comment-form-subscribe' ).slideDown();
		jQuery( '#commentform .form-submit' ).slideDown();
	});
}
jQuery(document).ready( highlander_expando_javascript );
</script>

<div id="comment-form-subscribe" style="display: none;">
	<p class="comment-subscription-form"><input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;" tabindex="6"> <label class="subscribe-label" id="subscribe-label" for="subscribe" style="display: inline;">Notify me of new comments via email.</label></p></div>




<p class="form-submit" style="display: none;"><input name="submit" type="submit" id="comment-submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="822" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="db3a5bfa73"></p>
<input type="hidden" name="genseq" value="1459302636">
<p style="display: none;"></p>				<input type="hidden" id="ak_js" name="ak_js" value="1459302635895"></form>
					</div><!-- #respond -->
		<div style="clear: both"></div>
</div><!-- #comments -->
	</div>

<div id="sidebar">

	<div id="text-3" class="widget widget_text"><h4>Blog browser</h4>			<div class="textwidget"><a href="https://seblagarde.wordpress.com/site-map/">Display all posts and recent updates</a></div>
		</div>		<div id="recent-posts-3" class="widget widget_recent_entries">		<h4>Recent Posts</h4>		<ul>
					<li>
				<a href="https://seblagarde.wordpress.com/2015/07/14/siggraph-2014-moving-frostbite-to-physically-based-rendering/">Siggraph 2014 : Moving Frostbite to Physically based rendering&nbsp;V2</a>
						</li>
					<li>
				<a href="https://seblagarde.wordpress.com/2014/12/01/inverse-trigonometric-functions-gpu-optimization-for-amd-gcn-architecture/">Inverse trigonometric functions GPU optimization for AMD GCN&nbsp;architecture</a>
						</li>
					<li>
				<a href="https://seblagarde.wordpress.com/2014/11/05/ies-light-format-specification-and-reader/">IES light format: Specification and&nbsp;reader</a>
						</li>
					<li>
				<a href="https://seblagarde.wordpress.com/2014/05/03/weathering-and-aging-effects/">Weathering and aging effects in the hand of&nbsp;artists</a>
						</li>
				</ul>
		</div>		<div id="linkcat-1356" class="widget widget_links"><h4>Blogroll</h4>
	<ul class="xoxo blogroll">
<li><a href="http://c0de517e.blogspot.com/">Angelo Pesce (c0de517e)</a></li>
<li><a href="http://aras-p.info/blog/">Aras Pranckeviciu</a></li>
<li><a href="http://bartwronski.com/">Bart Wronski</a></li>
<li><a href="http://graphicrants.blogspot.com/">Brian Karis</a></li>
<li><a href="http://cgzoo.wordpress.com/">Carlos Gonzalez-Ochoa</a></li>
<li><a href="http://realtimecollisiondetection.net/blog">Christer Ericson</a></li>
<li><a href="http://www.thetenthplanet.de/">Christian Sch√ºler</a></li>
<li><a href="http://zigguratvertigo.com/">Colin Barr√©-Brisebois (zigguratvertigo)</a></li>
<li><a href="http://blog.icare3d.org/">Cyril Crassin</a></li>
<li><a href="http://mycodefit.com/">Dimitar Lazarov</a></li>
<li><a href="http://www.humus.name/">Emil Persson (humus)</a></li>
<li><a href="http://fgiesen.wordpress.com/">Fabian Giesen (ryg)</a></li>
<li><a href="http://gware.blogspot.com/">Gabriel Ware</a></li>
<li><a href="http://www.ludicon.com/castano/blog/articles/">Ignacio Casta√±o</a></li>
<li><a href="http://www.jshopf.com/blog/">Jeremy Shopf</a></li>
<li><a href="http://repi.blogspot.com/">Johan Andersson (repi)</a></li>
<li><a href="http://filmicgames.com/">John Hable</a></li>
<li><a href="http://olickspulpit.blogspot.com/">Jon Olick</a></li>
<li><a href="http://www.iryoku.com/">Jorge Jimenez (iryoku)</a></li>
<li><a href="http://kriscg.blogspot.fr/">Krzysztof Narkowicz</a></li>
<li><a href="http://gaim.umbc.edu/">Marc Olano</a></li>
<li><a href="http://pixelstoomany.wordpress.com/">Marco Salvi</a></li>
<li><a href="http://rgba32.blogspot.com/">Mark Lee</a></li>
<li><a href="http://mynameismjp.wordpress.com/">Matt Pettineo (MJP)</a></li>
<li><a href="http://directtovideo.wordpress.com/">Matt Swoboda</a></li>
<li><a href="http://michaldrobot.com/">Michal Drobot</a></li>
<li><a href="http://www.dimension3.sk/">Michal Valient</a></li>
<li><a href="http://mmikkelsen3d.blogspot.com/">Morten Mikkelsen</a></li>
<li><a href="http://renderwonk.com/blog/">Nay Hoffmann (Renderwonk)</a></li>
<li><a href="http://psgraphics.blogspot.com/">Pete Shirley</a></li>
<li><a href="http://www.popekim.com/">Pope Kim</a></li>
<li><a href="http://www.rorydriscoll.com/">Rory Driscoll</a></li>
<li><a href="http://www.palgorithm.co.uk/">Sam Martin</a></li>
<li><a href="http://industrialarithmetic.blogspot.com/">Simon Green</a></li>
<li><a href="http://blog.selfshadow.com/">Stephen Hill (Self shadow)</a></li>
<li><a href="http://solid-angle.blogspot.com/">Steve Anichini</a></li>
<li><a href="http://blog.stevemcauley.com/">Steve McCauley</a></li>
<li><a href="http://www.spuify.co.uk/">Steven Tovey</a></li>
<li><a href="http://timothylottes.blogspot.com/">Timothy Lottes</a></li>
<li><a href="http://home.comcast.net/~tom_forsyth/blog.wiki.html">Tom Forsyth</a></li>
<li><a href="http://www.confettispecialfx.com/devblog">Wolfgang Engel</a></li>

	</ul>
</div>
<div id="linkcat-6270" class="widget widget_links"><h4>Publications</h4>
	<ul class="xoxo blogroll">
<li><a href="http://www.bitsquid.se/technology.html#papers">Bitsquid</a></li>
<li><a href="http://www.disney.co.uk/disneyinteractivestudios/blackrockstudio/technology/">Black rock studio</a></li>
<li><a href="http://www.bungie.net/Inside/publications.aspx">Bungie (Bad link ‚Äì Changed ?)</a></li>
<li><a href="http://www1.cs.columbia.edu/CAVE/publications/">CAVE (Columbia U)</a></li>
<li><a href="http://www.crytek.com/cryengine/presentations/">Crytek</a></li>
<li><a href="http://publications.dice.se/">Dice</a></li>
<li><a href="http://www.firaxis.com/?/blog">Firaxis</a></li>
<li><a href="http://www.guerrilla-games.com/publications/">Guerrilla</a></li>
<li><a href="http://www.insomniacgames.com/category/research-development/">Insomniac</a></li>
<li><a href="http://maverick.inria.fr/Publications/">Maverick(Inria)</a></li>
<li><a href="http://graphics.pixar.com/library/">Pixar</a></li>
<li><a href="http://wiki.polycount.com/CategoryReferenceGameArt">Polycount wiki Ref Art</a></li>
<li><a href="http://www.splashdamage.com/publications">Splash dammage</a></li>
<li><a href="http://www.jp.square-enix.com/info/library/">Square-Enix</a></li>
<li><a href="http://www.cg.tuwien.ac.at/research/rendering/publications/">Technische Universitat wien</a></li>
<li><a href="http://research.tri-ace.com/">Tri-ace research</a></li>
<li><a href="http://engineroom.ubi.com/">Ubisoft engineroom</a></li>
<li><a href="http://www.valvesoftware.com/publications.html">Valve</a></li>

	</ul>
</div>
<div id="twitter-3" class="widget widget_twitter"><h4><a href="http://twitter.com/SebLagarde">Twitter</a></h4><ul class="tweets">
			<li>
				RT @<a href="http://twitter.com/ArtbyRens">ArtbyRens</a>: Proud moment in my career as Kotaku highlights my work! <a href="https://twitter.com/Kotaku/status/714581041734950916"> twitter.com/Kotaku/status/‚Ä¶</a> 				<a href="http://twitter.com/SebLagarde/statuses/714679739412295681" class="timesince">20&nbsp;hours&nbsp;ago</a>
			</li>

			
			<li>
				RT @<a href="http://twitter.com/KostasAAA">KostasAAA</a>: Asynchronous Shaders Evolved: <a href="https://community.amd.com/community/gaming/blog/2016/03/28/asynchronous-shaders-evolved"> community.amd.com/community/gami‚Ä¶</a> 				<a href="http://twitter.com/SebLagarde/statuses/714678542731182083" class="timesince">20&nbsp;hours&nbsp;ago</a>
			</li>

			
			<li>
				RT @<a href="http://twitter.com/wolfgangengel">wolfgangengel</a>: One more call for Authors for GPU Pro 8: <a href="http://gpupro.blogspot.com/"> gpupro.blogspot.com</a> We are looking for everything graphics and VR. Please r‚Ä¶ 				<a href="http://twitter.com/SebLagarde/statuses/714678509436841985" class="timesince">20&nbsp;hours&nbsp;ago</a>
			</li>

			</ul><a href="http://twitter.com/SebLagarde" class="twitter-follow-button" data-show-count="false" data-link-color="#008DCF" data-text-color="#555555">Follow @SebLagarde</a></div>
</div>
</div>


<div id="footer">
	<div class="footerleft">
		<p><a href="https://wordpress.com/?ref=footer_website">Create a free website or blog at WordPress.com.</a></p>
    </div>
    <div class="footerright">
	    <a href="https://wordpress.com/themes/enterprise/" title="Learn more about this theme">The Enterprise Theme</a>.    </div>
</div>

</div>

<!-- wpcom_wp_footer -->
<script type="text/javascript" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/gprofiles.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type="text/javascript" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/wpgroho.js"></script>

	<script>
		//initialize and attach hovercards to all gravatars
		jQuery( document ).ready( function( $ ) {

			if (typeof Gravatar === "undefined"){
				return;
			}

			if ( typeof Gravatar.init !== "function" ) {
				return;
			}			

			Gravatar.profile_cb = function( hash, id ) {
				WPGroHo.syncProfileData( hash, id );
			};
			Gravatar.my_hash = WPGroHo.my_hash;
			Gravatar.init( 'body', '#wp-admin-bar-my-account' );
		});
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-0fcf23f6111f7ae962c50f515d8c0186">
	</div>
	<div class="grofile-hash-map-3d50dd95b36b7d788f02d3150fec97c0">
	</div>
	<div class="grofile-hash-map-d8dc4169e1d600fcfc9c5bf7a9058041">
	</div>
	<div class="grofile-hash-map-8918b44022dc1e822a0cf824e60d2a39">
	</div>
	</div>
<script type="text/javascript">
/* <![CDATA[ */
var HighlanderComments = {"loggingInText":"Logging In\u2026","submittingText":"Posting Comment\u2026","postCommentText":"Post Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s: You are commenting using your %2$s account.","logoutText":"Log Out","loginText":"Log In","connectURL":"https:\/\/seblagarde.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"https:\/\/seblagarde.wordpress.com\/wp-login.php?action=logout&_wpnonce=0dfe80ca44","homeURL":"https:\/\/seblagarde.wordpress.com\/","postID":"822","gravDefault":"identicon","enterACommentError":"Please enter a comment","enterEmailError":"Please enter your email address here","invalidEmailError":"Invalid email address","enterAuthorError":"Please enter your name here","gravatarFromEmail":"This picture will show whenever you leave a comment. Click to customize it.","logInToExternalAccount":"Log in to use details from one of these accounts.","change":"Change","changeAccount":"Change Account","comment_registration":"0","userIsLoggedIn":"","isJetpack":"0","text_direction":"ltr"};
/* ]]> */
</script>
<script type="text/javascript" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/saved_resource(5)"></script>

	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/seblagarde.wordpress.com\/2012\/06\/03\/spherical-gaussien-approximation-for-blinn-phong-phong-and-fresnel\/":822};
	</script>
		<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-facebook' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-google-plus-1' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomgoogle-plus-1', 'menubar=1,resizable=1,width=480,height=550' );
				return false;
			});
		});
		</script>
		<script type="text/javascript" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/form.js"></script>
<script type="text/javascript" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/widgets.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var JetpackEmojiSettings = {"base_url":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/emoji\/twemoji\/"};
/* ]]> */
</script>
<script type="text/javascript">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/saved_resource(6)"></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>	<script type="text/javascript">
	var skimlinks_pub_id = "725X584219"
	var skimlinks_sitename = "seblagarde.wordpress.com";
	</script>
	<script type="text/javascript" src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/725X1342.skimlinks.js"></script>		<iframe src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/master.html" scrolling="no" id="likes-master" name="likes-master" style="display:none;"></iframe>
		<div id="likes-other-gravatars"><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
		<script type="text/javascript">
		//<![CDATA[
			var jetpackLikesWidgetQueue = [];
			var jetpackLikesWidgetBatch = [];
			var jetpackLikesMasterReady = false;

			function JetpackLikespostMessage( message, target ) {
				if ( "string" === typeof message ){
					try{
						message = JSON.parse( message );
					}
					catch(e) {
						return;
					}
				}

				pm( {
					target: target,
					type: 'likesMessage',
					data: message,
					origin: '*'
				} );
			}

			function JetpackLikesBatchHandler() {
				var requests = [];
				jQuery( 'div.jetpack-likes-widget-unloaded' ).each( function( i ) {
					if ( jetpackLikesWidgetBatch.indexOf( this.id ) > -1 )
						return;
					jetpackLikesWidgetBatch.push( this.id );
					var regex = /like-(post|comment)-wrapper-(\d+)-(\d+)-(\w+)/;
					var match = regex.exec( this.id );
					if ( ! match || match.length != 5 )
						return;

					var info = {
						blog_id: match[2],
						width:   this.width
					};

					if ( 'post' == match[1] ) {
						info.post_id = match[3];
					} else if ( 'comment' == match[1] ) {
						info.comment_id = match[3];
					}

					info.obj_id = match[4];

					requests.push( info );
				});

				if ( requests.length > 0 ) {
					JetpackLikespostMessage( { event: 'initialBatch', requests: requests }, window.frames['likes-master'] );
				}
			}

			function JetpackLikesMessageListener( event ) {
				if ( "undefined" == typeof event.event )
					return;

				if ( 'masterReady' == event.event ) {
					jQuery( document ).ready( function() {
						jetpackLikesMasterReady = true;

						var stylesData = {
								event: 'injectStyles'
						};

						if ( jQuery( 'iframe.admin-bar-likes-widget' ).length > 0 ) {
							JetpackLikespostMessage( { event: 'adminBarEnabled' }, window.frames[ 'likes-master' ] );

							stylesData.adminBarStyles = {
								background: jQuery( '#wpadminbar .quicklinks li#wp-admin-bar-wpl-like > a' ).css( 'background' ),
								isRtl: ( 'rtl' == jQuery( '#wpadminbar' ).css( 'direction' ) )
							};
						}

						if ( !window.addEventListener )
							jQuery( '#wp-admin-bar-admin-bar-likes-widget' ).hide();

						stylesData.textStyles = {
							color: jQuery( '.sd-text-color').css( 'color' ),
							fontFamily: jQuery( '.sd-text-color' ).css( 'font-family' ),
							fontSize: jQuery( '.sd-text-color' ).css( 'font-size' ),
							direction: jQuery( '.sd-text-color' ).css( 'direction' ),
							fontWeight: jQuery( '.sd-text-color' ).css( 'font-weight' ),
							fontStyle: jQuery( '.sd-text-color' ).css( 'font-style' ),
							textDecoration: jQuery( '.sd-text-color' ).css('text-decoration')
						};

						stylesData.linkStyles = {
							color: jQuery( '.sd-link-color' ).css('color'),
							fontFamily: jQuery( '.sd-link-color' ).css('font-family'),
							fontSize: jQuery( '.sd-link-color' ).css('font-size'),
							textDecoration: jQuery( '.sd-link-color' ).css('text-decoration'),
							fontWeight: jQuery( '.sd-link-color' ).css( 'font-weight' ),
							fontStyle: jQuery( '.sd-link-color' ).css( 'font-style' )
						};

						JetpackLikespostMessage( stylesData, window.frames[ 'likes-master' ] );

						JetpackLikesBatchHandler();

						jQuery( document ).on( 'inview', 'div.jetpack-likes-widget-unloaded', function() {
							jetpackLikesWidgetQueue.push( this.id );
						});
					});
				}

				if ( 'showLikeWidget' == event.event ) {
					jQuery( '#' + event.id + ' .post-likes-widget-placeholder'  ).fadeOut( 'fast', function() {
						jQuery( '#' + event.id + ' .post-likes-widget' ).fadeIn( 'fast', function() {
							JetpackLikespostMessage( { event: 'likeWidgetDisplayed', blog_id: event.blog_id, post_id: event.post_id, obj_id: event.obj_id }, window.frames['likes-master'] );
						});
					});
				}

				if ( 'clickReblogFlair' == event.event ) {
					wpcom_reblog.toggle_reblog_box_flair( event.obj_id );
				}

				if ( 'showOtherGravatars' == event.event ) {
					var $container = jQuery( '#likes-other-gravatars' );
					var $list = $container.find( 'ul' );

					$container.hide();
					$list.html( '' );

					$container.find( '.likes-text span' ).text( event.total );

					jQuery.each( event.likers, function( i, liker ) {
						$list.append( '<li class="' + liker.css_class + '"><a href="' + liker.profile_URL + '" class="wpl-liker" rel="nofollow" target="_parent"><img src="' + liker.avatar_URL + '" alt="' + liker.name + '" width="30" height="30" style="padding-right: 3px;" /></a></li>');
					} );

					var offset = jQuery( "[name='" + event.parent + "']" ).offset();

					$container.css( 'left', offset.left + event.position.left - 10 + 'px' );
					$container.css( 'top', offset.top + event.position.top - 33 + 'px' );

					var rowLength = Math.floor( event.width / 37 );
					var height = ( Math.ceil( event.likers.length / rowLength ) * 37 ) + 13;
					if ( height > 204 ) {
						height = 204;
					}

					$container.css( 'height', height + 'px' );
					$container.css( 'width', rowLength * 37 - 7 + 'px' );

					$list.css( 'width', rowLength * 37 + 'px' );

					$container.fadeIn( 'slow' );

					var scrollbarWidth = $list[0].offsetWidth - $list[0].clientWidth;
					if ( scrollbarWidth > 0 ) {
						$container.width( $container.width() + scrollbarWidth );
						$list.width( $list.width() + scrollbarWidth );
					}
				}
			}

			pm.bind( 'likesMessage', function(e) { JetpackLikesMessageListener(e); } );

			jQuery( document ).click( function( e ) {
				var $container = jQuery( '#likes-other-gravatars' );

				if ( $container.has( e.target ).length === 0 ) {
					$container.fadeOut( 'slow' );
				}
			});

			function JetpackLikesWidgetQueueHandler() {
				var wrapperID;
				if ( ! jetpackLikesMasterReady ) {
					setTimeout( JetpackLikesWidgetQueueHandler, 500 );
					return;
				}

				if ( jetpackLikesWidgetQueue.length > 0 ) {
					// We may have a widget that needs creating now
					var found = false;
					while( jetpackLikesWidgetQueue.length > 0 ) {
						// Grab the first member of the queue that isn't already loading.
						wrapperID = jetpackLikesWidgetQueue.splice( 0, 1 )[0];
						if ( jQuery( '#' + wrapperID ).hasClass( 'jetpack-likes-widget-unloaded' ) ) {
							found = true;
							break;
						}
					}
					if ( ! found ) {
						setTimeout( JetpackLikesWidgetQueueHandler, 500 );
						return;
					}
				} else if ( jQuery( 'div.jetpack-likes-widget-unloaded' ).length > 0 ) {
					// Grab any unloaded widgets for a batch request
					JetpackLikesBatchHandler();

					// Get the next unloaded widget
					wrapperID = jQuery( 'div.jetpack-likes-widget-unloaded' ).first()[0].id;
					if ( ! wrapperID ) {
						// Everything is currently loaded
						setTimeout( JetpackLikesWidgetQueueHandler, 500 );
						return;
					}
				}

				if ( 'undefined' === typeof wrapperID ) {
					setTimeout( JetpackLikesWidgetQueueHandler, 500 );
					return;
				}

				var $wrapper = jQuery( '#' + wrapperID );
				$wrapper.find( 'iframe' ).remove();

				if ( $wrapper.hasClass( 'slim-likes-widget' ) ) {
					$wrapper.find( '.post-likes-widget-placeholder' ).after( "<iframe class='post-likes-widget jetpack-likes-widget' name='" + $wrapper.data( 'name' ) + "' height='22px' width='68px' frameBorder='0' scrolling='no' src='" + $wrapper.data( 'src' ) + "'></iframe>" );
				} else {
					$wrapper.find( '.post-likes-widget-placeholder' ).after( "<iframe class='post-likes-widget jetpack-likes-widget' name='" + $wrapper.data( 'name' ) + "' height='55px' width='100%' frameBorder='0' src='" + $wrapper.data( 'src' ) + "'></iframe>" );
				}

				$wrapper.removeClass( 'jetpack-likes-widget-unloaded' ).addClass( 'jetpack-likes-widget-loading' );

				$wrapper.find( 'iframe' ).load( function( e ) {
					var $iframe = jQuery( e.target );
					$wrapper.removeClass( 'jetpack-likes-widget-loading' ).addClass( 'jetpack-likes-widget-loaded' );

					JetpackLikespostMessage( { event: 'loadLikeWidget', name: $iframe.attr( 'name' ), width: $iframe.width() }, window.frames[ 'likes-master' ] );

					if ( $wrapper.hasClass( 'slim-likes-widget' ) ) {
						$wrapper.find( 'iframe' ).Jetpack( 'resizeable' );
					}
				});
				setTimeout( JetpackLikesWidgetQueueHandler, 250 );
			}
			JetpackLikesWidgetQueueHandler();
		//]]>
		</script>
<script src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/w.js" type="text/javascript" async="" defer=""></script>
<script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'25674879','blog_tz':'0','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'25674879','v':'wpcom','tz':'0','user_id':'0','post':'822','subd':'seblagarde'}]);
_stq.push(['extra', {'crypt':'UE5XaGUuOTlwaD85flAmcm1mcmZsaDhkV11YdWFnNncxc1tjZG9XVXhReTFqanhKV3x0UkRXYlpyS24vdVZvQkMvZ21relRld0JHa1R3RyVWd189LEhKY1I2SUY9cjRqRUUsUGQmNmZvaSUmMXByMVFTfEszdkxCMmpFXXFPQWQ5XXpCSnRiLlo1RiVFTUM0X05BU041d3YsK3BxTVZIbFZGRkdJeE0lNVBiUlV5WkU1d2RWUXwvcXVZajkmdk5YJUdkSD0yU3wzMV01a3A1aVAsOX5aNlYwV1tTazF+ciwwJl1UOHhPWiVLSltBdWpS'}]);
_stq.push([ 'clickTrackerInit', '25674879', '822' ]);
	</script>
<noscript>&lt;img src="https://pixel.wp.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /&gt;</noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>

<img src="./Spherical Gaussian approximation for Blinn-Phong, Phong and Fresnel _ S√©bastien Lagarde_files/g.gif" id="wpstats"></body></html>