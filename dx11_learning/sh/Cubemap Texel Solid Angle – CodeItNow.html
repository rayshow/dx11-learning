<!DOCTYPE html>
<!-- saved from url=(0065)http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/ -->
<html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

		        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="profile" href="http://gmpg.org/xfn/11">
        <link rel="pingback" href="http://www.rorydriscoll.com/xmlrpc.php">
    <title>Cubemap Texel Solid Angle – CodeItNow</title>
<link rel="alternate" type="application/rss+xml" title="CodeItNow » Feed" href="http://www.rorydriscoll.com/feed/">
<link rel="alternate" type="application/rss+xml" title="CodeItNow » Comments Feed" href="http://www.rorydriscoll.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="CodeItNow » Cubemap Texel Solid Angle Comments Feed" href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/feed/">
		<script type="text/javascript" async="" src="./Cubemap Texel Solid Angle – CodeItNow_files/ga.js"></script><script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/www.rorydriscoll.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.2"}};
			!function(a,b,c){function d(a){var c,d=b.createElement("canvas"),e=d.getContext&&d.getContext("2d"),f=String.fromCharCode;return e&&e.fillText?(e.textBaseline="top",e.font="600 32px Arial","flag"===a?(e.fillText(f(55356,56806,55356,56826),0,0),d.toDataURL().length>3e3):"diversity"===a?(e.fillText(f(55356,57221),0,0),c=e.getImageData(16,16,1,1).data.toString(),e.fillText(f(55356,57221,55356,57343),0,0),c!==e.getImageData(16,16,1,1).data.toString()):("simple"===a?e.fillText(f(55357,56835),0,0):e.fillText(f(55356,57135),0,0),0!==e.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./Cubemap Texel Solid Angle – CodeItNow_files/wp-emoji-release.min.js" type="text/javascript"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="wp-quicklatex-format-css" href="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex-format.css" type="text/css" media="all">
<link rel="stylesheet" id="acmeblog-bxslider-css-css" href="./Cubemap Texel Solid Angle – CodeItNow_files/jquery.bxslider.min.css" type="text/css" media="all">
<link rel="stylesheet" id="acmeblog-googleapis-css" href="./Cubemap Texel Solid Angle – CodeItNow_files/css" type="text/css" media="all">
<link rel="stylesheet" id="acmeblog-fontawesome-css" href="./Cubemap Texel Solid Angle – CodeItNow_files/font-awesome.min.css" type="text/css" media="all">
<link rel="stylesheet" id="acmeblog-style-css" href="./Cubemap Texel Solid Angle – CodeItNow_files/style.css" type="text/css" media="all">
<style id="acmeblog-style-inline-css" type="text/css">

            mark,
            .comment-form .form-submit input,
            .slider-section .cat-links a,
            #calendar_wrap #wp-calendar #today,
            #calendar_wrap #wp-calendar #today a,
            .wpcf7-form input.wpcf7-submit:hover,
            .breadcrumb{
                background: #dd3333;
            }
            a:hover,
            .header-wrapper .menu li a:hover,
            .screen-reader-text:focus,
            .bn-content a:hover,
            .socials a:hover,
            .site-title a,
            .widget_search input#s,
            .besides-slider .post-title a:hover,
            .slider-feature-wrap a:hover,
            .slider-section .bx-controls-direction a,
            .besides-slider .beside-post:hover .beside-caption,
            .besides-slider .beside-post:hover .beside-caption a:hover,
            .featured-desc .above-entry-meta span:hover,
            .posted-on a:hover,
            .cat-links a:hover,
            .comments-link a:hover,
            .edit-link a:hover,
            .tags-links a:hover,
            .byline a:hover,
            .nav-links a:hover,
            #acmeblog-breadcrumbs a:hover,
            .wpcf7-form input.wpcf7-submit,
            .widget li a:hover,
            .header-wrapper .menu > li.current-menu-item > a,
            .header-wrapper .menu > li.current-menu-parent > a,
            .header-wrapper .menu > li.current_page_parent > a,
            .header-wrapper .menu > li.current_page_ancestor > a{
                color: #dd3333;
            }
         .nav-links .nav-previous a:hover,
            .nav-links .nav-next a:hover{
                border-top: 1px solid #dd3333;
            }
            .besides-slider .beside-post{
                border-bottom: 3px solid #dd3333;
            }
            .page-header .page-title,
            .single .entry-header .entry-title{
                border-bottom: 1px solid #dd3333;
            }
            .page-header .page-title:before,
            .single .entry-header .entry-title:before{
                border-bottom: 7px solid #dd3333;
            }
            .wpcf7-form input.wpcf7-submit:hover,
            article.post.sticky,
            .read-more:hover{
                border: 2px solid #dd3333;
            }
            .breadcrumb::after {
                border-left: 5px solid #dd3333;
            }
            .tagcloud a{
                border: 1px solid #dd3333;
            }
            .widget-title{
                border-left: 2px solid #dd3333;
            }
         
            @media screen and (max-width:992px){
                .slicknav_btn.slicknav_open{
                    border: 1px solid #dd3333;
                }
                .slicknav_btn.slicknav_open:before{
                    background: #dd3333;
                    box-shadow: 0 6px 0 0 #dd3333, 0 12px 0 0 #dd3333;
                }
                .slicknav_nav li:hover > a,
                .slicknav_nav li.current-menu-ancestor a,
                .slicknav_nav li.current-menu-item  > a,
                .slicknav_nav li.current_page_item a,
                .slicknav_nav li.current_page_item .slicknav_item span,
                .slicknav_nav li .slicknav_item:hover a{
                    color: #dd3333;
                }
            }
</style>
<script type="text/javascript" src="./Cubemap Texel Solid Angle – CodeItNow_files/jquery.js"></script>
<script type="text/javascript" src="./Cubemap Texel Solid Angle – CodeItNow_files/jquery-migrate.min.js"></script>
<script type="text/javascript" src="./Cubemap Texel Solid Angle – CodeItNow_files/img-mouseover.js"></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='http://www.rorydriscoll.com/wp-content/themes/acmeblog/assets/library/html5shiv/html5shiv.min.js?ver=3.7.3'></script>
<![endif]-->
<!--[if lt IE 9]>
<script type='text/javascript' src='http://www.rorydriscoll.com/wp-content/themes/acmeblog/assets/library/respond/respond.min.js?ver=1.1.2'></script>
<![endif]-->
<script type="text/javascript" src="./Cubemap Texel Solid Angle – CodeItNow_files/wp-quicklatex-frontend.js"></script>
<script type="text/javascript" src="./Cubemap Texel Solid Angle – CodeItNow_files/external-tracking.min.js"></script>
<link rel="https://api.w.org/" href="http://www.rorydriscoll.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.rorydriscoll.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.rorydriscoll.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Derivative Maps" href="http://www.rorydriscoll.com/2012/01/11/derivative-maps/">
<link rel="next" title="Derivative Maps vs Normal Maps" href="http://www.rorydriscoll.com/2012/01/15/derivative-maps-vs-normal-maps/">
<meta name="generator" content="WordPress 4.4.2">
<link rel="canonical" href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/">
<link rel="shortlink" href="http://www.rorydriscoll.com/?p=759">
<link rel="alternate" type="application/json+oembed" href="http://www.rorydriscoll.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.rorydriscoll.com%2F2012%2F01%2F15%2Fcubemap-texel-solid-angle%2F">
<link rel="alternate" type="text/xml+oembed" href="http://www.rorydriscoll.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.rorydriscoll.com%2F2012%2F01%2F15%2Fcubemap-texel-solid-angle%2F&amp;format=xml">
<link rel="stylesheet" type="text/css" href="./Cubemap Texel Solid Angle – CodeItNow_files/shCore.css"><link rel="stylesheet" type="text/css" href="./Cubemap Texel Solid Angle – CodeItNow_files/shThemeDefault.css"><style type="text/css" id="syntaxhighlighteranchor"></style>
<!-- Google Analytics Tracking by Google Analyticator 6.4.9: http://www.videousermanuals.com/google-analyticator/ -->
<script type="text/javascript">
    var analyticsFileTypes = [''];
    var analyticsSnippet = 'enabled';
    var analyticsEventTracking = 'enabled';
</script>
<script type="text/javascript">
	var _gaq = _gaq || [];
  
	_gaq.push(['_setAccount', 'UA-6635139-1']);
    _gaq.push(['_addDevId', 'i9k95']); // Google Analyticator App ID with Google
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
	</head>
<body class="single single-post postid-759 single-format-standard boxed-layout blog-no-image right-sidebar">

        <div id="page" class="hfeed site">
        <a class="skip-link screen-reader-text" href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/#content" title="link">Skip to content</a>
            <header id="masthead" class="site-header" role="banner">
            <div class="wrapper header-wrapper clearfix">
                <div class="header-container">
                    <div class="site-branding clearfix">
                         <div class="date-display acme-col-3">Monday, March 21, 2016</div>                        <div class="site-logo acme-col-3">
                                                                                            <p class="site-title">
                                        <a href="http://www.rorydriscoll.com/" rel="home">CodeItNow</a>
                                    </p>
                                                            <!--acmeblog-header-id-display-opt-->
                        </div><!--site-logo-->

                        <div class="right-header acme-col-3 float-right">
                            <div class="acme-search-block"><span class="acme-toggle-search fa fa-search"></span><div class="search-block">
    <form action="http://www.rorydriscoll.com/" class="searchform" id="searchform" method="get" role="search">
        <div>
            <label for="menu-search" class="screen-reader-text"></label>
                        <input type="text" placeholder="Search" class="menu-search" id="menu-search" name="s" value="">
            <button class="searchsubmit fa fa-search" type="submit" id="searchsubmit"></button>
        </div>
    </form>
</div>
</div>        <div class="socials">
                            <a href="http://www.twitter.com/rorydriscoll" class="twitter" data-title="Twitter" target="_blank">
                    <span class="font-icon-social-twitter"><i class="fa fa-twitter"></i></span>
                </a>
                            <a href="http://www.youtube.com/rorydriscoll" class="youtube" data-title="Youtube" target="_blank">
                    <span class="font-icon-social-youtube"><i class="fa fa-youtube"></i></span>
                </a>
                    </div>
                                </div>
                    </div>
                    <nav id="site-navigation" class="main-navigation clearfix" role="navigation">
                        <div class="header-main-menu clearfix">
                                                            <div style="color: #ffffff;padding: 10px">
                                    Goto Appearance &gt; Menus -: for setting up menu                                 </div>
                                                        </div>
                        <!--slick menu container-->
                        <div class="responsive-slick-menu clearfix"></div>
                    </nav>
                    <!-- #site-navigation -->
                </div>
                <!-- .header-container -->
            </div>
            <!-- header-wrapper-->
        </header>
        <!-- #masthead -->
            <div class="wrapper content-wrapper clearfix">
            <div id="content" class="site-content">
    	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-759" class="post-759 post type-post status-publish format-standard hentry category-general">
	<header class="entry-header">
		<h1 class="entry-title">Cubemap Texel Solid Angle</h1>
		<div class="entry-meta">
			<span class="posted-on"><a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/" rel="bookmark"><i class="fa fa-calendar"></i><time class="entry-date published" datetime="2012-01-15T13:42:18+00:00">January 15, 2012</time><time class="updated" datetime="2012-03-22T22:03:50+00:00">March 22, 2012</time></a></span><span class="byline"> <span class="author vcard"><a class="url fn n" href="http://www.rorydriscoll.com/author/rory/"><i class="fa fa-user"></i>Rory</a></span></span>		</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

	<!--post thumbnal options-->
	<div class="single-feat clearfix">
		<figure class="single-thumb single-thumb-full">
							<img src="./Cubemap Texel Solid Angle – CodeItNow_files/no-image-690-400.jpg" alt="Cubemap Texel Solid Angle" title="Cubemap Texel Solid Angle">
						</figure>
	</div><!-- .single-feat-->

	<div class="entry-content">
		<table width="90%" align="center" cellpadding="10" cellspacing="1" bgcolor="#f7f7f7" border="0">
<tbody><tr>
<td>
<b>Warning:</b> This post is going to be pretty math heavy. If you suck at math, then go and read <a href="http://www.thebestpageintheuniverse.net/c.cgi?u=math">this</a> first, then come back. If you still think that you suck, then I suggest going to <a href="http://www.khanacademy.org/">Khan Academy</a> and start watching videos. You won’t regret it!
</td>
</tr>
</tbody></table>
<p>I was reading through the <a href="http://code.google.com/p/cubemapgen/">AMD CubeMapGen source</a> last week and came across the code for calculating the solid angle of a cube map texel. This code piqued my interest, since it seemed very terse for what I thought would be a horrific calculation.</p>
<div><div id="highlighter_254790" class="syntaxhighlighter  cpp"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">static</code> <code class="cpp plain">float32 AreaElement( float32 x, float32 y )</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp functions bold">atan2</code><code class="cpp plain">(x * y, </code><code class="cpp functions bold">sqrt</code><code class="cpp plain">(x * x + y * y + 1));</code></div><div class="line number4 index3 alt1"><code class="cpp plain">}</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="cpp plain">float32 TexelCoordSolidAngle(int32 a_FaceIdx, float32 a_U, float32 a_V, int32 a_Size)</code></div><div class="line number7 index6 alt2"><code class="cpp plain">{</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//scale up to [-1, 1] range (inclusive), offset by 0.5 to point to texel center.</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">float32 U = (2.0f * ((float32)a_U + 0.5f) / (float32)a_Size ) - 1.0f;</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">float32 V = (2.0f * ((float32)a_V + 0.5f) / (float32)a_Size ) - 1.0f;</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">float32 InvResolution = 1.0f / a_Size;</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// U and V are the -1..1 texture coordinate on the current face.</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Get projected area for this texel</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">float32 x0 = U - InvResolution;</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">float32 y0 = V - InvResolution;</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">float32 x1 = U + InvResolution;</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">float32 y1 = V + InvResolution;</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">float32 SolidAngle = AreaElement(x0, y0) - AreaElement(x0, y1) - AreaElement(x1, y0) + AreaElement(x1, y1);</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">SolidAngle;</code></div><div class="line number23 index22 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>The source code for this particular part is well documented, and points you towards <a href="http://www.fizzmoll11.com/thesis/thesis.pdf">this thesis</a> by Manne Öhrström (<a href="https://twitter.com/#!/manneohrstrom">@manneohrstrom</a>) where he gives a high level overview of the derivation. I was interested in finding out some more of the details, so I had a go myself, and this post is the result.</p>
<h2>Why is it Useful?</h2>
<p><a href="./Cubemap Texel Solid Angle – CodeItNow_files/FilteredEnvMap.png"><img src="./Cubemap Texel Solid Angle – CodeItNow_files/FilteredEnvMap.png" alt="" title="FilteredEnvMap" width="196" height="196" class="alignright size-full wp-image-979"></a></p>
<p>When processing cube maps (for example, generating a diffuse irradiance map, or spherical harmonic approximation), you need to be able to integrate the texel values over a sphere. </p>
<p>One way of approximating this integral is to use a Monte Carlo estimator. This is a statistical technique that may oversample some texels and undersample other. This seems a bit wasteful considering that we have a finite number of input values. Ideally we’d like to use each texel value just once.</p>
<p>A naive approach to analytical integration where each texel has the same weight would result in overly bright values in the corner areas. This is because the texels in the corners project to smaller and smaller areas on the sphere. The correct approach is to factor in the solid angle during the integral, and this is what CubeMapGen does.</p>
<h2>The Plan</h2>
<p>Imagine a single cube map face placed at (0,0,1) and scaled such that the texel locations are all in [-1,1]. For any texel in this cube map, we want to project it onto a unit sphere sitting at the origin, then work out the area on the sphere. This area corresponds to the solid angle because the sphere is a unit sphere.</p>
<p>We can repeat this same calculation for any of the other cube map faces by first transforming them into the same range. </p>
<p><a href="./Cubemap Texel Solid Angle – CodeItNow_files/TexelProjection.png"><img src="./Cubemap Texel Solid Angle – CodeItNow_files/TexelProjection.png" alt="" title="TexelProjection" width="400" height="410" class="aligncenter size-full wp-image-870"></a></p>
<p>This is the high-level game plan for calculating out the solid angle:</p>
<ol>
<li>Determine a formula for projecting a position from texture-space onto the sphere.</li>
<li>Work out how this projected position changes as the texture-space coordinates change in x and y.</li>
<li>Imagining that these position change vectors define two sides of a microscopic quadrilateral, then calculate the microscopic area of this quad using the magnitude of the cross product.</li>
<li>Integrate the microscopic area using the corner coordinates of a texel to calculate its area on the sphere, and solid angle.</li>
</ol>
<h2>The Details</h2>
<p>We start off with the formula for projecting a point from its location on the texture face (x, y, 1) onto the unit sphere. This is just a standard vector normalization.</p>
<p class="ql-center-displayed-equation" style="line-height: 50px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-daa796d4ca2f5ee61899317d00838d61_l3.png" height="50" width="141" class="ql-img-displayed-equation " alt="\begin{align*} \vec{p} = \dfrac{\begin{pmatrix}x, y, 1 \end{pmatrix}}{\sqrt{x^2 + y^2+1}} \end{align*}" title="Rendered by QuickLaTeX.com"></p>
<table width="90%" align="center" cellpadding="10" cellspacing="1" bgcolor="#f7f7f7" border="0">
<tbody><tr>
<td>
<b>Note:</b> I’ll be switching back and forth between negative and fractional exponents as I see fit. This makes things easier. Remember, <img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-c9beaf5c04427d6698cf1443a55c3147_l3.png" class="ql-img-inline-formula " alt="x^{-n} = \frac{1}{x^n}" title="Rendered by QuickLaTeX.com" height="22" width="73" style="vertical-align: -6px;">, and <img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-fb697885f9d30c8a2d88d78798d88e16_l3.png" class="ql-img-inline-formula " alt="x^{\frac{1}{2}} = \sqrt{x}" title="Rendered by QuickLaTeX.com" height="22" width="70" style="vertical-align: -4px;">.
</td>
</tr>
</tbody></table>
<p>We want to calculate how this projected point changes as the texture-space x and y coordinates change. We can do this separately for each axis using partial derivatives. First we’ll start by calculating how the projected z component changes along to the texture-space x axis.</p>
<h3>Projected Z Change According to X</h3>
<p>The z-component of p is simply:</p>
<p class="ql-center-displayed-equation" style="line-height: 73px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-6281591c71b267a0c150f46b50d87b3d_l3.png" height="73" width="160" class="ql-img-displayed-equation " alt="\begin{align*} p_z &amp;= \dfrac{1}{\sqrt{x^2 + y^2+1}}\\ &amp;= (x^2 + y^2+1)^{-\frac{1}{2}} \end{align*}" title="Rendered by QuickLaTeX.com"></p>
<p>We need to differentiate this equation with respect to x. Because of the exponent, we need to use the chain rule to do this. The chain rule is a method for finding the derivative of the composition of two functions. First, we can reformulate the equation a little bit to make the two functions a bit clearer:</p>
<p class="ql-center-displayed-equation" style="line-height: 23px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-31f684ea7c54bd03992ea5baf43c43db_l3.png" height="23" width="200" class="ql-img-displayed-equation " alt="\begin{align*} p_z = u^{-\frac{1}{2}}, u = x^2 + y^2+1 \end{align*}" title="Rendered by QuickLaTeX.com"></p>
<p>In our case our first function is a function of <img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-43fe27dc3e528266a619764d90fce60b_l3.png" class="ql-img-inline-formula " alt="u" title="Rendered by QuickLaTeX.com" height="8" width="10" style="vertical-align: 0px;"> and our second function is a function of <img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-ede05c264bba0eda080918aaa09c4658_l3.png" class="ql-img-inline-formula " alt="x" title="Rendered by QuickLaTeX.com" height="8" width="10" style="vertical-align: 0px;"> and <img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-0af556714940c351c933bba8cf840796_l3.png" class="ql-img-inline-formula " alt="y" title="Rendered by QuickLaTeX.com" height="12" width="9" style="vertical-align: -4px;">. Given this, the chain rule says:</p>
<p class="ql-center-displayed-equation" style="line-height: 39px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-6f170398dabb2f22172e26279dffd4b3_l3.png" height="39" width="106" class="ql-img-displayed-equation " alt="\begin{align*} \frac{\partial p_z}{\partial x} = \frac{\partial p_z}{\partial u} \frac{\partial u}{\partial x} \end{align*}" title="Rendered by QuickLaTeX.com"></p>
<p>We can apply this rule very easily to our reformulated functions:</p>
<p class="ql-center-displayed-equation" style="line-height: 220px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-ae0b2428e50b1171daec7bafca098554_l3.png" height="220" width="190" class="ql-img-displayed-equation " alt="\begin{align*} \frac{\partial p_z}{\partial u} &amp;=-\frac{u^{-\frac{3}{2}}}{2}\\ &amp;=-\frac{1}{2(x^2+y^2+1)^{\frac{3}{2}}} \\[10] \frac{\partial u}{\partial x}&amp;=2x\\[10] \frac{\partial p_z}{\partial x} &amp;= -\frac{x}{(x^2+y^2+1)^{\frac{3}{2}}} \end{align*}" title="Rendered by QuickLaTeX.com"></p>
<p>This equation tells us exactly how the z component of the projected point changes as the texture-space position moves along the x axis.</p>
<h3>Projected X Change According to X</h3>
<p>Now we’ve found the projected z component derivative, it’s going to make finding the x and y components a little easier. Why? Because we can express the x and y components in terms of the z component.</p>
<p class="ql-center-displayed-equation" style="line-height: 65px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-34d9aaef6cd544ab1461e03a84d2ebd5_l3.png" height="65" width="150" class="ql-img-displayed-equation " alt="\begin{align*} p_x &amp;= \frac{x}{\sqrt{x^2 + y^2+1}}\\ &amp;= x p_z \end{align*}" title="Rendered by QuickLaTeX.com"></p>
<p>We don’t have the same ‘composition of functions’ setup that we did last time, so we can’t use the chain rule to differentiate this. Instead, we can use the product rule. The product rule in our case says:</p>
<p class="ql-center-displayed-equation" style="line-height: 40px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-d9af0578f8cbc7aea136da9efb618f6f_l3.png" height="40" width="183" class="ql-img-displayed-equation " alt="\begin{align*} \frac{\partial p_x}{\partial x} &amp;= p_z\frac{\partial (x)}{\partial x} + x\frac{\partial (p_z)}{\partial x} \end{align*}" title="Rendered by QuickLaTeX.com"></p>
<p>Applying this to equation for for the projected x component:</p>
<p class="ql-center-displayed-equation" style="line-height: 103px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-f9f74cdc622cf680b43663722f4df5f5_l3.png" height="103" width="304" class="ql-img-displayed-equation " alt="\begin{align*} \frac{\partial p_x}{\partial x} &amp;= \frac{1}{(x^2 + y^2+1)^{\frac{1}{2}}}-\frac{x^2}{(x^2+y^2+1)^{\frac{3}{2}}}\\ &amp;= \frac{y^2+1}{(x^2+y^2+1)^{\frac{3}{2}}} \end{align*}" title="Rendered by QuickLaTeX.com"></p>
<h3>Projected Y Change According to X</h3>
<p>We have a very similar derivation for the projected y derivative:</p>
<p class="ql-center-displayed-equation" style="line-height: 40px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-41dda9503b32046dad5add6b972d74ad_l3.png" height="40" width="200" class="ql-img-displayed-equation " alt="\begin{align*} p_y = \frac{y}{\sqrt{x^2 + y^2+1}} = y p_z \end{align*}" title="Rendered by QuickLaTeX.com"></p>
<p>We can use the product rule again:</p>
<p class="ql-center-displayed-equation" style="line-height: 85px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-2c4f3ec120ad14b9203f1fe9cda5fa02_l3.png" height="85" width="181" class="ql-img-displayed-equation " alt="\begin{align*} \frac{\partial p_y}{\partial x} &amp;= p_z\frac{\partial (y)}{\partial x} + y\frac{\partial (p_z)}{\partial x}\\ &amp;= -\frac{xy}{(x^2+y^2+1)^{\frac{3}{2}}} \end{align*}" title="Rendered by QuickLaTeX.com"></p>
<h3>Projected Position Change According to X and Y</h3>
<p>Putting this all together, we have our equation showing how the projected position changes as the texture-space position changes in the x direction. We can use the exact same process to work out how it moves in the y direction.</p>
<p class="ql-center-displayed-equation" style="line-height: 106px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-ab827bfce1e25c4fb911aaea12128a65_l3.png" height="106" width="186" class="ql-img-displayed-equation " alt="\begin{align*} \frac{\partial \vec{p}}{\partial x} &amp;= \frac{\begin{pmatrix}y^2+1,-xy, -x\end{pmatrix}}{(x^2+y^2+1)^{\frac{3}{2}}}\\ \frac{\partial \vec{p}}{\partial y} &amp;= \frac{\begin{pmatrix}-xy, x^2+1,-y\end{pmatrix}}{(x^2+y^2+1)^{\frac{3}{2}}} \end{align*}" title="Rendered by QuickLaTeX.com"></p>
<h3>Differential Area</h3>
<p>The next step is to calculate the differential (microscopic) area of the projected point using the partial derivatives we just calculated. Clearly at a normal scale, we wouldn’t be able to take the cross product of two projected vectors on a sphere and expect the magnitude to be the area they define on the sphere. But at this differential scale, we can treat the surface as if it is flat, so this works.</p>
<p>The first thing we need to do is to calculate the cross product of the partial derivatives.</p>
<p class="ql-center-displayed-equation" style="line-height: 96px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-827bec2eba8abd8e22b037b4205ed4ed_l3.png" height="96" width="334" class="ql-img-displayed-equation " alt="\begin{align*} \vec{r} &amp;= \frac{\partial \vec{p}}{\partial x} \times \frac{\partial \vec{p}}{\partial y}\\ &amp;= \frac{\begin{pmatrix}y^2+1,-xy, -x\end{pmatrix}}{(x^2 + y^2+1)^{\frac{3}{2}}} \times \frac{\begin{pmatrix}-xy, x^2+1,-y\end{pmatrix}}{(x^2 + y^2+1)^{\frac{3}{2}}} \end{align*}" title="Rendered by QuickLaTeX.com"></p>
<p>Calculating the cross product for each of the components relatively straightforward.</p>
<p class="ql-center-displayed-equation" style="line-height: 144px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-786b1317cba9bc442a11a75f1ab4b54f_l3.png" height="144" width="222" class="ql-img-displayed-equation " alt="\begin{align*} r_x &amp;= \frac{x^3+xy^2+x}{(x^2 + y^2+1)^3}\\ r_y &amp;= \frac{x^2y+y^3+y}{(x^2 + y^2+1)^3}\\ r_z &amp;= \frac{(y^2+1)(x^2+1)-x^2y^2}{(x^2 + y^2+1)^3}\\ \end{align*}" title="Rendered by QuickLaTeX.com"></p>
<p>If you’re reading carefully, you’ll notice that each component has a factor of <img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-8d9216d24c360332801b9b01ede93033_l3.png" class="ql-img-inline-formula " alt="x^2+y^2+1" title="Rendered by QuickLaTeX.com" height="19" width="86" style="vertical-align: -4px;"> on the top and the bottom, so we can divide through. Combining all the components back together again, we arrive at the final equation for the perpendicular vector.</p>
<p class="ql-center-displayed-equation" style="line-height: 43px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-f822cb9bc3c3b3b3b6ae38d63f92d219_l3.png" height="43" width="143" class="ql-img-displayed-equation " alt="\begin{align*} \vec{r} &amp;= \frac{(x,y,1)}{(x^2 + y^2+1)^2} \end{align*}" title="Rendered by QuickLaTeX.com"></p>
<p>Now we simply need to take the length of the result of the cross product to find the differential area on the sphere.</p>
<p class="ql-center-displayed-equation" style="line-height: 151px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-d01ca9cd76b91c518393ab4a9ad617bf_l3.png" height="151" width="178" class="ql-img-displayed-equation " alt="\begin{align*} \partial A &amp;= \sqrt{\vec{r} \cdot \vec{r}}\\[5] &amp;= \sqrt{\frac{x^2+y^2+1}{(x^2 + y^2+1)^4}}\\[5] &amp;= \frac{1}{(x^2 + y^2+1)^{\frac{3}{2}}} \end{align*}" title="Rendered by QuickLaTeX.com"></p>
<h3>Solid Angle</h3>
<p>The final step is to integrate the differential area over our range of texture-space values to get the solid angle of the texel. We can start by calculating the integral between <img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-9cf2000c782cfe94be6df5f499cd3e24_l3.png" class="ql-img-inline-formula " alt="(0,0)" title="Rendered by QuickLaTeX.com" height="18" width="38" style="vertical-align: -4px;"> and some point <img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-29dc6bb5c0d77f139941a7a167e1b164_l3.png" class="ql-img-inline-formula " alt="(s,t)" title="Rendered by QuickLaTeX.com" height="18" width="34" style="vertical-align: -4px;"> on the cube map face.</p>
<p class="ql-center-displayed-equation" style="line-height: 95px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-de12d8d6b7a16ee514769d04570a8156_l3.png" height="95" width="308" class="ql-img-displayed-equation " alt="\begin{align*} f(s,t)&amp;=\int_{y=0}^t\int_{x=0}^s \frac{1}{(x^2+y^2+1)^{\frac{3}{2}}} \,\mathrm{d}x\, \mathrm{d}y\\ &amp;=\mathrm{tan}^{-1}\frac{st}{\sqrt{s^2+t^2+1}} \end{align*}" title="Rendered by QuickLaTeX.com"></p>
<p>From this formula, we can calculate the area of any texel in the cube map face by adding together the two right-diagonal corners, A and C, and subtracting the left-diagonal corners, B and D. </p>
<p class="ql-center-displayed-equation" style="line-height: 18px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-ab67ae51f09ddb951225dd4437469c3e_l3.png" height="18" width="254" class="ql-img-displayed-equation " alt="\begin{align*} S=f(A) - f(B) + f(C) - f(D) \end{align*}" title="Rendered by QuickLaTeX.com"></p>
<p>You can see on the image below that the added areas in green are canceled out by the subtracted areas in red.</p>
<p><a href="./Cubemap Texel Solid Angle – CodeItNow_files/Area.png"><img src="./Cubemap Texel Solid Angle – CodeItNow_files/Area.png" alt="" title="Area" width="400" height="417" class="aligncenter size-full wp-image-893"></a></p>
<p>That should look familiar, since that’s exactly what the CubeMapGen code does. If you look at the surrounding source code to TexelCoordSolidAngle, then you’ll notice that there’s another method mentioned for calculating the solid angle of a texel. This method is based on Girard’s theorem, which describes how to calculate the area of a spherical triangle based on the excess of the sum of its interior angles. This method was also suggested to me on Twitter by Ignacio Castaño (<a href="https://twitter.com/#!/castano">@castano</a>). I haven’t actually tried it, but it looks fascinating!</p>
<h2>Is it Correct?</h2>
<p>It’s always a bit daunting to get to the end of a derivation like this, and not know if the answer is correct or not. In this case, it’s pretty easy to verify if this result is correct. </p>
<p>Remember that the texture-space coordinates are in range [-1,1]. If we set our <img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-76f553ea5055b27082c28955d9ece578_l3.png" class="ql-img-inline-formula " alt="(x,y)" title="Rendered by QuickLaTeX.com" height="18" width="39" style="vertical-align: -4px;"> values to 1, that corresponds to the top right quarter of the cube map face. We know that there are <img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-a64f86508ea52835b7fd42736282275d_l3.png" class="ql-img-inline-formula " alt="4\pi" title="Rendered by QuickLaTeX.com" height="13" width="20" style="vertical-align: -1px;"> steradians in a sphere, so that means that each face gets <img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-0d5f0508005e85f68bfe0ed48e803e40_l3.png" class="ql-img-inline-formula " alt="\frac{2\pi}{3}" title="Rendered by QuickLaTeX.com" height="22" width="16" style="vertical-align: -6px;"> steradians. Since we’re only calculating for a quarter of a face we expect our result to be <img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-38b9dcafd63e963896575ed3fca15de1_l3.png" class="ql-img-inline-formula " alt="\frac{\pi}{6}" title="Rendered by QuickLaTeX.com" height="19" width="9" style="vertical-align: -6px;">.</p>
<p class="ql-center-displayed-equation" style="line-height: 78px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-68598b2241da90f392546ab98484ea91_l3.png" height="78" width="144" class="ql-img-displayed-equation " alt="\begin{align*} f(1,1)&amp;=\mathrm{tan}^{-1}\frac{1}{\sqrt{3}}\\ &amp;= \frac{\pi}{6} \end{align*}" title="Rendered by QuickLaTeX.com"></p>
<p>And it does. Thanks to the various people on twitter (<a href="https://twitter.com/#!/SebLagarde">@SebLagarde</a>, <a href="https://twitter.com/#!/mattpharr">@mattpharr</a>, <a href="https://twitter.com/#!/manneohrstrom">@manneohrstrom</a>, <a href="https://twitter.com/#!/castano">@castano</a> and <a href="https://twitter.com/#!/ChristerEricson">@ChristerEricson</a>) for engaging me in conversation over this.</p>
<p>Please let me know in the comments if you spot an error in this post, or if anything needs to be explained better or more easily.</p>
			</div><!-- .entry-content -->

	<footer class="entry-footer">
		<span class="cat-links"><i class="fa fa-folder-o"></i><a href="http://www.rorydriscoll.com/category/general/" rel="category tag">General</a></span>	</footer><!-- .entry-footer -->
</article><!-- #post-## -->

			
	<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="http://www.rorydriscoll.com/2012/01/11/derivative-maps/" rel="prev">Derivative Maps</a></div><div class="nav-next"><a href="http://www.rorydriscoll.com/2012/01/15/derivative-maps-vs-normal-maps/" rel="next">Derivative Maps vs Normal Maps</a></div></div>
	</nav>
			
<div id="comments" class="comments-area">

	
			<h2 class="comments-title">
			17 thoughts on “<span>Cubemap Texel Solid Angle</span>”		</h2>

		
		<ol class="comment-list">
			        <li class="comment even thread-even depth-1" id="comment-1201">
                    <div id="div-comment-1201" class="comment-body clearfix">
                <div class="comment-author vcard">
            <img alt="" src="./Cubemap Texel Solid Angle – CodeItNow_files/e67c6d5fd86a8a950ee7709e204929b0" srcset="http://2.gravatar.com/avatar/e67c6d5fd86a8a950ee7709e204929b0?s=128&amp;d=mm&amp;r=g 2x" class="avatar avatar-64 photo" height="64" width="64">            <cite class="fn">David Neubelt</cite>        </div>
                <div class="comment-meta commentmetadata">
            <a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/#comment-1201">
                <i class="fa fa-clock-o"></i>
                January 15, 2012 at 7:10 pm            </a>
                    </div>
        <p>I did a different derivation for this a long time ago when I first had to do projection for SH. I think it’s a little simpler.</p>
<p>I’d post the derivation for it here in the comments but I put it on google wave and lost all my documents when I didn’t pay attention to them closing up shop. If you want I can post a full derivation.</p>
<p>The high level sketch of the derivation is,</p>
<p>Given a spherical-coordinate on the unit sphere, (\theta, \phi), find the projected coordinate in polar coordinates on the top cube face (r,t). First find the mapping r(\theta, \phi), t(\theta, \phi). From calculus we know the differential area of a sphere surface is sin(\phi) d\phi d\theta and we also know the differential area of a surface in polar coordinates is r d\r d\t, then we can take our new mapping r(\theta, \phi), t(\theta, \phi) plug it into our differential and find the scaling factor from the projection.</p>
<p>From symmetry we can find all other faces and integration is simple.</p>
<p>-= Dave</p>
        <div class="reply">
                    </div>
                    </div>
                </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1203">
                    <div id="div-comment-1203" class="comment-body clearfix">
                <div class="comment-author vcard">
            <img alt="" src="./Cubemap Texel Solid Angle – CodeItNow_files/e67c6d5fd86a8a950ee7709e204929b0" srcset="http://2.gravatar.com/avatar/e67c6d5fd86a8a950ee7709e204929b0?s=128&amp;d=mm&amp;r=g 2x" class="avatar avatar-64 photo" height="64" width="64">            <cite class="fn">David Neubelt</cite>        </div>
                <div class="comment-meta commentmetadata">
            <a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/#comment-1203">
                <i class="fa fa-clock-o"></i>
                January 15, 2012 at 7:42 pm            </a>
                    </div>
        <p>Here is some quick LaTeX I whipped up of the above description. I don’t know if comments accept images so I’ll put the source as well. Basically, the 1/cos(phi)^3 is the scaling factor between the area on the sphere and projected area.</p>
<p>The only other tricky part is recognizing that cos(phi) is L – the length of line from the origin to the cartesian coordinate of the texel.</p>
<p><img src="./Cubemap Texel Solid Angle – CodeItNow_files/quicklatex.com-18eda5fc169bfcb394284d5d7167c0d4_l3.png" class="ql-img-inline-formula " alt=" r(\theta, \phi) = tan(\phi)\\ t(\theta, \phi) = \theta \\ dA_{spherical} = sin(\theta)d\theta d\phi \\ dA_{polar} = r dr d\theta_2 \\ dA_{projected} = r(\theta, \phi) dr(\theta, \phi) d \theta \\ dA_{projected} = tan(\phi) sec^2(\phi) d\phi d\theta \\ dA_{projected} = dA_{spherical} \\ tan(\phi) sec^2(\phi) d\phi d\theta = sin(\theta)d\theta d\phi \\ \frac{sin(\phi)}{cos(\phi)} \frac{1}{cos^2(\phi)} d\phi d\theta = sin(\theta)d\theta d\phi \\ \frac{1}{cos^3(\phi)} \\ \frac{1}{L^3} = \frac{1}{\sqrt{(1 + x^2 + y^2)^{3/2}}} " title="Rendered by QuickLaTeX.com" height="261" width="254" style="vertical-align: -15px;"></p>
        <div class="reply">
                    </div>
                    </div>
                </li><!-- #comment-## -->
        <li class="comment even thread-even depth-1" id="comment-1204">
                    <div id="div-comment-1204" class="comment-body clearfix">
                <div class="comment-author vcard">
            <img alt="" src="./Cubemap Texel Solid Angle – CodeItNow_files/e67c6d5fd86a8a950ee7709e204929b0" srcset="http://2.gravatar.com/avatar/e67c6d5fd86a8a950ee7709e204929b0?s=128&amp;d=mm&amp;r=g 2x" class="avatar avatar-64 photo" height="64" width="64">            <cite class="fn">David Neubelt</cite>        </div>
                <div class="comment-meta commentmetadata">
            <a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/#comment-1204">
                <i class="fa fa-clock-o"></i>
                January 15, 2012 at 7:43 pm            </a>
                    </div>
        <p>Looks like they don’t accept html images <img src="./Cubemap Texel Solid Angle – CodeItNow_files/frownie.png" alt=":(" class="wp-smiley" style="height: 1em; max-height: 1em;"> Sorry!</p>
        <div class="reply">
                    </div>
                    </div>
                </li><!-- #comment-## -->
        <li class="comment byuser comment-author-rory bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1211">
                    <div id="div-comment-1211" class="comment-body clearfix">
                <div class="comment-author vcard">
            <img alt="" src="./Cubemap Texel Solid Angle – CodeItNow_files/9c6e7b4719dd0132116b0ac7f9e43c37" srcset="http://0.gravatar.com/avatar/9c6e7b4719dd0132116b0ac7f9e43c37?s=128&amp;d=mm&amp;r=g 2x" class="avatar avatar-64 photo" height="64" width="64">            <cite class="fn">rory</cite>        </div>
                <div class="comment-meta commentmetadata">
            <a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/#comment-1211">
                <i class="fa fa-clock-o"></i>
                January 16, 2012 at 8:40 am            </a>
                    </div>
        <p>I edited your comment to put the latex tags around the math. Thanks for the alternate derivation.</p>
<p>I also had a go at the Girard’s theorem derivation, but it really didn’t come out much simpler. Girard’s theorem itself is very nice, but calculating the angles of the spherical triangle turned out to be a bit of a mess. I didn’t put too much time into it though, so I daresay there’s a simpler way to calculate the angles than I did.</p>
        <div class="reply">
                    </div>
                    </div>
                </li><!-- #comment-## -->
        <li class="comment even thread-even depth-1" id="comment-1212">
                    <div id="div-comment-1212" class="comment-body clearfix">
                <div class="comment-author vcard">
            <img alt="" src="./Cubemap Texel Solid Angle – CodeItNow_files/e67c6d5fd86a8a950ee7709e204929b0" srcset="http://2.gravatar.com/avatar/e67c6d5fd86a8a950ee7709e204929b0?s=128&amp;d=mm&amp;r=g 2x" class="avatar avatar-64 photo" height="64" width="64">            <cite class="fn">David Neubelt</cite>        </div>
                <div class="comment-meta commentmetadata">
            <a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/#comment-1212">
                <i class="fa fa-clock-o"></i>
                January 16, 2012 at 10:13 am            </a>
                    </div>
        <p>I’ve actually used spherical triangles in the past to allow arbitrary meshes to be quickly projected onto spherical harmonics. E.g. if artists want to paint a mesh in Maya to be used as area lighting. </p>
<p><a href="http://www.whim.org/nebula/math/pdf/spheretrig.pdf" rel="nofollow">http://www.whim.org/nebula/math/pdf/spheretrig.pdf</a> </p>
<p>Lot of good easy to digest info in that document. I don’t think I’d use it for cube map convolution w/ a brdf though. I like the 1/L^3 formula as its pretty simple.</p>
        <div class="reply">
                    </div>
                    </div>
                </li><!-- #comment-## -->
        <li class="comment byuser comment-author-rory bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1213">
                    <div id="div-comment-1213" class="comment-body clearfix">
                <div class="comment-author vcard">
            <img alt="" src="./Cubemap Texel Solid Angle – CodeItNow_files/9c6e7b4719dd0132116b0ac7f9e43c37" srcset="http://0.gravatar.com/avatar/9c6e7b4719dd0132116b0ac7f9e43c37?s=128&amp;d=mm&amp;r=g 2x" class="avatar avatar-64 photo" height="64" width="64">            <cite class="fn">rory</cite>        </div>
                <div class="comment-meta commentmetadata">
            <a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/#comment-1213">
                <i class="fa fa-clock-o"></i>
                January 16, 2012 at 10:55 am            </a>
                    </div>
        <p>That’s a nice idea to be able to project arbitrary meshes like that. Was that used in any games?</p>
<p>I actually used the formula in section 9 (L’Huilier’s Formula) to calculate the texel area when I had a go. It felt like it could be simpler when added to the arc length calculation for the sides of the triangle.</p>
        <div class="reply">
                    </div>
                    </div>
                </li><!-- #comment-## -->
        <li class="pingback even thread-even depth-1" id="comment-1214">
                    <div id="div-comment-1214" class="comment-body clearfix">
                <div class="comment-author vcard">
                        <cite class="fn"><a href="http://seblagarde.wordpress.com/2012/01/12/amd-cubemapgen-for-physically-based-rendering/" rel="external nofollow" class="url">AMD Cubemapgen for physically based rendering « Sébastien Lagarde</a></cite>        </div>
                <div class="comment-meta commentmetadata">
            <a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/#comment-1214">
                <i class="fa fa-clock-o"></i>
                January 16, 2012 at 2:47 pm            </a>
                    </div>
        <p>[…] [7] Discroll, “Cubemap Texel Solid Angle” <a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/" rel="nofollow">http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/</a>  Advertisement  LD_AddCustomAttr("AdOpt", "1"); LD_AddCustomAttr("Origin", "other"); […]</p>
        <div class="reply">
                    </div>
                    </div>
                </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1218">
                    <div id="div-comment-1218" class="comment-body clearfix">
                <div class="comment-author vcard">
            <img alt="" src="./Cubemap Texel Solid Angle – CodeItNow_files/e67c6d5fd86a8a950ee7709e204929b0" srcset="http://2.gravatar.com/avatar/e67c6d5fd86a8a950ee7709e204929b0?s=128&amp;d=mm&amp;r=g 2x" class="avatar avatar-64 photo" height="64" width="64">            <cite class="fn">David Neubelt</cite>        </div>
                <div class="comment-meta commentmetadata">
            <a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/#comment-1218">
                <i class="fa fa-clock-o"></i>
                January 16, 2012 at 8:15 pm            </a>
                    </div>
        <p>Unfortunately, the code hasn’t made its way to a shipped game yet. Maybe in the future we can have this conversation again.</p>
<p>I can say that the artists preferred throwing a cube in Maya, tessellating it, painting the vertices with their paint tool and seeing the lighting change in realtime over painting a cube map in photoshop. It also allows them to do  things like light the cube via light sources or whatever else their imagination comes up with.</p>
<p>-= Dave</p>
        <div class="reply">
                    </div>
                    </div>
                </li><!-- #comment-## -->
        <li class="comment even thread-even depth-1" id="comment-1219">
                    <div id="div-comment-1219" class="comment-body clearfix">
                <div class="comment-author vcard">
            <img alt="" src="./Cubemap Texel Solid Angle – CodeItNow_files/b632aa3d298fd42f64d2547abad08ae8" srcset="http://2.gravatar.com/avatar/b632aa3d298fd42f64d2547abad08ae8?s=128&amp;d=mm&amp;r=g 2x" class="avatar avatar-64 photo" height="64" width="64">            <cite class="fn">Manne Ohrstrom</cite>        </div>
                <div class="comment-meta commentmetadata">
            <a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/#comment-1219">
                <i class="fa fa-clock-o"></i>
                January 17, 2012 at 4:45 am            </a>
                    </div>
        <p>@David: Very Cool! Yeah, what’s nice about expressing light as an SH coefficient is that it such a compact description of a spherical signal! And since it is an L^2 basis, it blends nicely, both temporally and spatially and as overlays – back in 2003 when I wrote my thesis we also built tools so that artists could paint on cube maps and add artificial light to scenes – we also precomputed light in the scene by baking SH coeffs and sprinkling them around the scene. Light was then applied to dynamic objects by adding the static precomputed lights with the hand edited effects-lights. It is quite cool, especially when animated over time. And it is high dynamic range too – back in the day that was a big deal. <img src="./Cubemap Texel Solid Angle – CodeItNow_files/simple-smile.png" alt=":)" class="wp-smiley" style="height: 1em; max-height: 1em;"></p>
        <div class="reply">
                    </div>
                    </div>
                </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1224">
                    <div id="div-comment-1224" class="comment-body clearfix">
                <div class="comment-author vcard">
            <img alt="" src="./Cubemap Texel Solid Angle – CodeItNow_files/e67c6d5fd86a8a950ee7709e204929b0" srcset="http://2.gravatar.com/avatar/e67c6d5fd86a8a950ee7709e204929b0?s=128&amp;d=mm&amp;r=g 2x" class="avatar avatar-64 photo" height="64" width="64">            <cite class="fn">David Neubelt</cite>        </div>
                <div class="comment-meta commentmetadata">
            <a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/#comment-1224">
                <i class="fa fa-clock-o"></i>
                January 17, 2012 at 1:58 pm            </a>
                    </div>
        <p>@Manne, Yah it is a lot of fun. I’m sad I didn’t read your paper when I originally did a lot of this work, skimming it now seems like you did good work. We did a lot of similar things from what you said as well.</p>
<p>I’m now of the opinion that I prefer high quality static bakes over the low frequency dynamic lighting solutions SH can offer. This is my opinion of course, but I’d rather wait 10 seconds for a high quality bake then iterate on low frequency solutions.</p>
<p>Anywhoo, things change all the time so maybe I’ll be singing a different tune in a year. Good work regardless!</p>
<p>And rory, I really enjoy the math heavy blogs, keep them coming <img src="./Cubemap Texel Solid Angle – CodeItNow_files/simple-smile.png" alt=":)" class="wp-smiley" style="height: 1em; max-height: 1em;"></p>
<p>-= Dave</p>
        <div class="reply">
                    </div>
                    </div>
                </li><!-- #comment-## -->
        <li class="comment even thread-even depth-1" id="comment-1257">
                    <div id="div-comment-1257" class="comment-body clearfix">
                <div class="comment-author vcard">
            <img alt="" src="./Cubemap Texel Solid Angle – CodeItNow_files/9287097a8078b33924b37f53b70d5ecd" srcset="http://0.gravatar.com/avatar/9287097a8078b33924b37f53b70d5ecd?s=128&amp;d=mm&amp;r=g 2x" class="avatar avatar-64 photo" height="64" width="64">            <cite class="fn">Dan</cite>        </div>
                <div class="comment-meta commentmetadata">
            <a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/#comment-1257">
                <i class="fa fa-clock-o"></i>
                January 27, 2012 at 5:07 pm            </a>
                    </div>
        <p>Hey Rory,</p>
<p>Peter-Pike presents a simplified version in his “Stupid SH Tricks” paper. He takes the integral of (1+s^2+t^2)-(3/2) over [-1..1]. Wolfram Alpha tells me that “integrate 1/(1+x^2+y^2)^(3/2) dx dy, x=-1..1, y=-1..1” equals 4Pi/6, which makes sense, each face of the cube map takes a sixth of the area of the surface of the sphere. [if we summed all little areas of texture coordinates on -1 to 1].</p>
<p>Because for a low number of discrete steps, the final sum won’t quiet be 4Pi, Peter-Pike normalizes the final result to 4Pi. The resulting code looks quite simple. No arctan in sight!</p>
        <div class="reply">
                    </div>
                    </div>
                </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1258">
                    <div id="div-comment-1258" class="comment-body clearfix">
                <div class="comment-author vcard">
            <img alt="" src="./Cubemap Texel Solid Angle – CodeItNow_files/9287097a8078b33924b37f53b70d5ecd" srcset="http://0.gravatar.com/avatar/9287097a8078b33924b37f53b70d5ecd?s=128&amp;d=mm&amp;r=g 2x" class="avatar avatar-64 photo" height="64" width="64">            <cite class="fn">Dan</cite>        </div>
                <div class="comment-meta commentmetadata">
            <a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/#comment-1258">
                <i class="fa fa-clock-o"></i>
                January 27, 2012 at 5:22 pm            </a>
                    </div>
        <p>Hey Rory,</p>
<p>Peter-Pike presents a simplified version in his “Stupid SH Tricks” paper. He takes the sum of 4.0/(1 + s^t + t^2)^(3/2) for each texel s and t in the range [-1 .. 1] and normalizes the result at the end by multiplying by 4Pi/Sum(all weights). The resulting code looks quite simple. No arctan in sight!</p>
<p>-djg</p>
        <div class="reply">
                    </div>
                    </div>
                </li><!-- #comment-## -->
        <li class="comment even thread-even depth-1" id="comment-1259">
                    <div id="div-comment-1259" class="comment-body clearfix">
                <div class="comment-author vcard">
            <img alt="" src="./Cubemap Texel Solid Angle – CodeItNow_files/9287097a8078b33924b37f53b70d5ecd" srcset="http://0.gravatar.com/avatar/9287097a8078b33924b37f53b70d5ecd?s=128&amp;d=mm&amp;r=g 2x" class="avatar avatar-64 photo" height="64" width="64">            <cite class="fn">Dan</cite>        </div>
                <div class="comment-meta commentmetadata">
            <a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/#comment-1259">
                <i class="fa fa-clock-o"></i>
                January 27, 2012 at 5:33 pm            </a>
                    </div>
        <p>Here’s a bit of python code as proof of concept:<br>
<a href="http://www.pastebin.com/dHk7w9Rs" rel="nofollow">http://www.pastebin.com/dHk7w9Rs</a></p>
        <div class="reply">
                    </div>
                    </div>
                </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1288">
                    <div id="div-comment-1288" class="comment-body clearfix">
                <div class="comment-author vcard">
            <img alt="" src="./Cubemap Texel Solid Angle – CodeItNow_files/15a365fef941cf4086d1b00e64aafb17" srcset="http://1.gravatar.com/avatar/15a365fef941cf4086d1b00e64aafb17?s=128&amp;d=mm&amp;r=g 2x" class="avatar avatar-64 photo" height="64" width="64">            <cite class="fn">Gian</cite>        </div>
                <div class="comment-meta commentmetadata">
            <a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/#comment-1288">
                <i class="fa fa-clock-o"></i>
                March 22, 2012 at 8:44 am            </a>
                    </div>
        <p>Hi,<br>
in case of GPU radiosity is a better idea to calculate the solid angle as these calculations or just use a texture as explained here?</p>
<p><a href="http://freespace.virgin.net/hugo.elias/radiosity/radiosity.htm" rel="nofollow">http://freespace.virgin.net/hugo.elias/radiosity/radiosity.htm</a></p>
<p>i was searching practical information about solid angles for other mappings (ex. spherical, dual paraboloid) but there’s not much fully explained in the internet.<br>
I’ve found something in the source code from Chapter 10 of GPU Gems 2 (see BuildTextures.cpp if interested) about dual paraboloid projection and the cubemap one of course</p>
<p><a href="http://developer.nvidia.com/node/28" rel="nofollow">http://developer.nvidia.com/node/28</a></p>
<p>do you know any book or link that could help me? Or could you make some extra post about it? <img draggable="false" class="emoji" alt="😉" src="./Cubemap Texel Solid Angle – CodeItNow_files/1f609.png"> I know they are not good projections in certain situations but i’d to experiment anyway and possibly try something like this one</p>
<p><a href="http://www.youtube.com/watch?v=Z9u8EdFbmiI" rel="nofollow">http://www.youtube.com/watch?v=Z9u8EdFbmiI</a></p>
<p>Thanks</p>
        <div class="reply">
                    </div>
                    </div>
                </li><!-- #comment-## -->
        <li class="comment byuser comment-author-rory bypostauthor even thread-even depth-1" id="comment-1289">
                    <div id="div-comment-1289" class="comment-body clearfix">
                <div class="comment-author vcard">
            <img alt="" src="./Cubemap Texel Solid Angle – CodeItNow_files/9c6e7b4719dd0132116b0ac7f9e43c37" srcset="http://0.gravatar.com/avatar/9c6e7b4719dd0132116b0ac7f9e43c37?s=128&amp;d=mm&amp;r=g 2x" class="avatar avatar-64 photo" height="64" width="64">            <cite class="fn">Rory</cite>        </div>
                <div class="comment-meta commentmetadata">
            <a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/#comment-1289">
                <i class="fa fa-clock-o"></i>
                March 22, 2012 at 9:02 am            </a>
                    </div>
        <p>The texture in the link you sent looks like a precomputed version of what I outlined in this article, so it’s perfectly fine to use it.</p>
<p>I’m afraid I haven’t even thought about other mappings, though I’m sure others have. I haven’t look, but I would imagine that the ‘Physcally Based Rendering’ book might have some information on this.</p>
        <div class="reply">
                    </div>
                    </div>
                </li><!-- #comment-## -->
        <li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1290">
                    <div id="div-comment-1290" class="comment-body clearfix">
                <div class="comment-author vcard">
            <img alt="" src="./Cubemap Texel Solid Angle – CodeItNow_files/5bfd65be96a3339f048963eeeee7dd2e" srcset="http://2.gravatar.com/avatar/5bfd65be96a3339f048963eeeee7dd2e?s=128&amp;d=mm&amp;r=g 2x" class="avatar avatar-64 photo" height="64" width="64">            <cite class="fn"><a href="http://yuriks.net/" rel="external nofollow" class="url">yuriks</a></cite>        </div>
                <div class="comment-meta commentmetadata">
            <a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/#comment-1290">
                <i class="fa fa-clock-o"></i>
                March 22, 2012 at 9:56 pm            </a>
                    </div>
        <p>Hello, I believe you have a typo in one of the steps. Right after the cross product, shouldn’t the expoent at the bottom be ^3? It’s what I always get, and it checks out with the rest of the article after I divide the polynomials.</p>
        <div class="reply">
                    </div>
                    </div>
                </li><!-- #comment-## -->
        <li class="comment byuser comment-author-rory bypostauthor even thread-even depth-1" id="comment-1291">
                    <div id="div-comment-1291" class="comment-body clearfix">
                <div class="comment-author vcard">
            <img alt="" src="./Cubemap Texel Solid Angle – CodeItNow_files/9c6e7b4719dd0132116b0ac7f9e43c37" srcset="http://0.gravatar.com/avatar/9c6e7b4719dd0132116b0ac7f9e43c37?s=128&amp;d=mm&amp;r=g 2x" class="avatar avatar-64 photo" height="64" width="64">            <cite class="fn">Rory</cite>        </div>
                <div class="comment-meta commentmetadata">
            <a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/#comment-1291">
                <i class="fa fa-clock-o"></i>
                March 22, 2012 at 10:05 pm            </a>
                    </div>
        <p>Yes, thanks for pointing that out. I’ve fixed it now.</p>
        <div class="reply">
                    </div>
                    </div>
                </li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
			<p class="no-comments">Comments are closed.</p>
	
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->
	<div id="secondary-right" class="widget-area sidebar secondary-sidebar" role="complementary">
		<div id="sidebar-section-top" class="widget-area sidebar clearfix">
			<aside id="categories-118636211" class="widget widget_categories"><h3 class="widget-title"><span>Categories</span></h3>		<ul>
	<li class="cat-item cat-item-17"><a href="http://www.rorydriscoll.com/category/addins/">Addins</a>
</li>
	<li class="cat-item cat-item-16"><a href="http://www.rorydriscoll.com/category/arduino/">Arduino</a>
</li>
	<li class="cat-item cat-item-12"><a href="http://www.rorydriscoll.com/category/c-35/">C# 3.5</a>
</li>
	<li class="cat-item cat-item-5"><a href="http://www.rorydriscoll.com/category/c/">C++</a>
</li>
	<li class="cat-item cat-item-11"><a href="http://www.rorydriscoll.com/category/general/">General</a>
</li>
	<li class="cat-item cat-item-13"><a href="http://www.rorydriscoll.com/category/graphics/global-illumination/">Global Illumination</a>
</li>
	<li class="cat-item cat-item-8"><a href="http://www.rorydriscoll.com/category/graphics/">Graphics</a>
</li>
	<li class="cat-item cat-item-14"><a href="http://www.rorydriscoll.com/category/graphics/global-illumination/irradiance-caching/">Irradiance Caching</a>
</li>
	<li class="cat-item cat-item-4"><a href="http://www.rorydriscoll.com/category/mockitnow/">MockItNow</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://www.rorydriscoll.com/category/uncategorized/">Uncategorized</a>
</li>
		</ul>
</aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h3 class="widget-title"><span>Recent Posts</span></h3>		<ul>
					<li>
				<a href="http://www.rorydriscoll.com/2016/03/07/frame-rate-independent-damping-using-lerp/">Frame Rate Independent Damping using Lerp</a>
						</li>
					<li>
				<a href="http://www.rorydriscoll.com/2013/11/22/physically-based-shading/">Physically-Based Shading</a>
						</li>
					<li>
				<a href="http://www.rorydriscoll.com/2012/01/22/derivative-map-artifacts/">Derivative Map Artifacts</a>
						</li>
					<li>
				<a href="http://www.rorydriscoll.com/2012/01/15/derivative-maps-vs-normal-maps/">Derivative Maps vs Normal Maps</a>
						</li>
					<li>
				<a href="http://www.rorydriscoll.com/2012/01/15/cubemap-texel-solid-angle/">Cubemap Texel Solid Angle</a>
						</li>
				</ul>
		</aside>				</div>
	</div>
        </div><!-- #content -->
        </div><!-- content-wrapper-->
            <div class="clearfix"></div>
        <footer id="colophon" class="site-footer" role="contentinfo">
            <div class="wrapper footer-wrapper">
                <div class="footer-copyright border text-center">
                                            <p>AcmeThemes © 2015</p>
                                        <div class="site-info">
                    <a href="https://wordpress.org/">Proudly powered by WordPress</a>
                    <span class="sep"> | </span>
                    Theme: AcmeBlog by <a href="http://www.acmethemes.com/" rel="designer">AcmeThemes</a>.                    </div><!-- .site-info -->
                </div>
            </div><!-- footer-wrapper-->
        </footer><!-- #colophon -->
            </div><!-- #page -->
    <script type="text/javascript" src="./Cubemap Texel Solid Angle – CodeItNow_files/shCore.js"></script>
<script type="text/javascript" src="./Cubemap Texel Solid Angle – CodeItNow_files/shBrushCpp.js"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://www.rorydriscoll.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://www.rorydriscoll.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script type="text/javascript" src="./Cubemap Texel Solid Angle – CodeItNow_files/jquery.bxslider.min.js"></script>
<script type="text/javascript" src="./Cubemap Texel Solid Angle – CodeItNow_files/acmeblog-custom.js"></script>
<script type="text/javascript" src="./Cubemap Texel Solid Angle – CodeItNow_files/wp-embed.min.js"></script>

</body></html>